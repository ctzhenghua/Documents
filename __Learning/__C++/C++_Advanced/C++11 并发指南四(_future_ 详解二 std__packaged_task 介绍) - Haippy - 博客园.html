<!DOCTYPE html>
<!-- saved from url=(0044)http://www.cnblogs.com/haippy/p/3279565.html -->
<html lang="zh-cn"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script src="./C++11 并发指南四(_future_ 详解二 std__packaged_task 介绍) - Haippy - 博客园_files/id.php" charset="utf-8"></script><script type="text/javascript" src="./C++11 并发指南四(_future_ 详解二 std__packaged_task 介绍) - Haippy - 博客园_files/encoder.js.下载"></script>

<meta name="viewport" content="width=device-width, initial-scale=1">
<title>C++11 并发指南四(&lt;future&gt; 详解二 std::packaged_task 介绍) - Haippy - 博客园</title>
<link type="text/css" rel="stylesheet" href="./C++11 并发指南四(_future_ 详解二 std__packaged_task 介绍) - Haippy - 博客园_files/blog-common.css">
<link id="MainCss" type="text/css" rel="stylesheet" href="./C++11 并发指南四(_future_ 详解二 std__packaged_task 介绍) - Haippy - 博客园_files/bundle-Minyx2_Lite.css">
<link id="mobile-style" media="only screen and (max-width: 768px)" type="text/css" rel="stylesheet" href="./C++11 并发指南四(_future_ 详解二 std__packaged_task 介绍) - Haippy - 博客园_files/bundle-Minyx2_Lite-mobile.css">
<link title="RSS" type="application/rss+xml" rel="alternate" href="http://www.cnblogs.com/haippy/rss">
<link title="RSD" type="application/rsd+xml" rel="EditURI" href="http://www.cnblogs.com/haippy/rsd.xml">
<link type="application/wlwmanifest+xml" rel="wlwmanifest" href="http://www.cnblogs.com/haippy/wlwmanifest.xml">
<script src="./C++11 并发指南四(_future_ 详解二 std__packaged_task 介绍) - Haippy - 博客园_files/jquery.js.下载" type="text/javascript"></script>  
<script type="text/javascript">var currentBlogApp = 'haippy', cb_enable_mathjax=false;var isLogined=true;</script>
<script src="./C++11 并发指南四(_future_ 详解二 std__packaged_task 介绍) - Haippy - 博客园_files/blog-common.js.下载" type="text/javascript"></script>
<script src="./C++11 并发指南四(_future_ 详解二 std__packaged_task 介绍) - Haippy - 博客园_files/bundle-Minyx2_Lite.js.下载" language="javascript" type="text/javascript"></script>
</head>
<body><link href="./C++11 并发指南四(_future_ 详解二 std__packaged_task 介绍) - Haippy - 博客园_files/jiathis_share.css" rel="stylesheet" type="text/css"><div class="jiathis_style" style="height: auto; position: fixed; z-index: 100000000; top: 150px; right: 0px; overflow: hidden; width: 26px;"><table cellpadding="0" cellspacing="0"><tbody style="background:transparent"><tr><td style="background:transparent"><img src="./C++11 并发指南四(_future_ 详解二 std__packaged_task 介绍) - Haippy - 博客园_files/r1.gif" style="cursor:pointer;" onmouseover="$CKE.over()" onclick="$CKE.center(this)"></td><td><div><div class="jiadiv_01"><div style="width:100%;background:#F2F2F2;border-bottom:1px solid #E5E5E5;line-height:200%;padding-left:5px;font-size:12px"><table width="100%"><tbody><tr class="jt_sharetitle"><td align="left" style="text-align:left;line-height:25px;font-size:14px;font-weight:bold;color:#000000;">分享到...</td><td align="right" style="text-align:right;"><img src="./C++11 并发指南四(_future_ 详解二 std__packaged_task 介绍) - Haippy - 博客园_files/img_exit.gif" border="0" style="opacity:0.5;filter:alpha(opacity=50);margin:0 10px;cursor:pointer;" onclick="$CKE.shareClose();"></td></tr></tbody></table></div><div class="jiadiv_02" style="width:100%;" id="jiathis_sers"><a href="javascript:;" onclick="jiathis_sendto(&#39;weixin&#39;);return false;" class="jiatitle"><span class="jtico jtico_weixin">微信</span></a><a href="javascript:;" onclick="jiathis_sendto(&#39;tsina&#39;);return false;" class="jiatitle"><span class="jtico jtico_tsina">微博</span></a><a href="javascript:;" onclick="jiathis_sendto(&#39;copy&#39;);return false;" class="jiatitle"><span class="jtico jtico_copy">复制网址</span></a><a href="javascript:;" onclick="jiathis_sendto(&#39;email&#39;);return false;" class="jiatitle"><span class="jtico jtico_email">邮件</span></a><a href="javascript:;" onclick="jiathis_sendto(&#39;cqq&#39;);return false;" class="jiatitle"><span class="jtico jtico_cqq">QQ好友</span></a><a href="javascript:;" onclick="jiathis_sendto(&#39;qzone&#39;);return false;" class="jiatitle"><span class="jtico jtico_qzone">QQ空间</span></a><a href="javascript:;" onclick="jiathis_sendto(&#39;renren&#39;);return false;" class="jiatitle"><span class="jtico jtico_renren">人人网</span></a><a href="javascript:;" onclick="jiathis_sendto(&#39;kaixin001&#39;);return false;" class="jiatitle"><span class="jtico jtico_kaixin001">开心网</span></a><a href="javascript:;" onclick="jiathis_sendto(&#39;evernote&#39;);return false;" class="jiatitle"><span class="jtico jtico_evernote">印象笔记</span></a><a href="javascript:;" onclick="jiathis_sendto(&#39;linkedin&#39;);return false;" class="jiatitle"><span class="jtico jtico_linkedin">领英</span></a><a href="javascript:;" onclick="jiathis_sendto(&#39;feixin&#39;);return false;" class="jiatitle"><span class="jtico jtico_feixin">飞信</span></a><a href="javascript:;" onclick="jiathis_sendto(&#39;douban&#39;);return false;" class="jiatitle"><span class="jtico jtico_douban">豆瓣</span></a><a href="javascript:;" onclick="jiathis_sendto(&#39;twitter&#39;);return false;" class="jiatitle"><span class="jtico jtico_twitter">Twitter</span></a><a href="javascript:;" onclick="jiathis_sendto(&#39;fb&#39;);return false;" class="jiatitle"><span class="jtico jtico_fb">Facebook</span></a><a href="javascript:;" onclick="jiathis_sendto(&#39;ishare&#39;);return false;" class="jiatitle"><span class="jtico jtico_ishare">一键分享</span></a><a href="javascript:;" onclick="$CKE.center(this);return false;" class="jiatitle"><span class="jtico jtico_jiathis">查看更多(96)</span></a><div style="clear:both"></div></div><div class="ckepopBottom" style="width:100%;"><div style="float:left;font-size:10px"><a href="http://www.jiathis.com/help/html/what-is-jiathis" class="link_01" style="color:#333333;display:none;" target="_blank">这是什么工具?</a></div><div style="float:right;font-size:11px;margin:0 5px 0 0;"><img src="./C++11 并发指南四(_future_ 详解二 std__packaged_task 介绍) - Haippy - 博客园_files/img_012.gif" align="absmiddle" border="0"><a href="http://www.jiathis.com/index2" style="color:#333333;padding:0 3px;" class="link_01" target="_blank">JiaThis</a></div><div style="clear:both"></div></div></div></div></td></tr></tbody></table></div><iframe frameborder="0" style="position: absolute; display: none;" src="./C++11 并发指南四(_future_ 详解二 std__packaged_task 介绍) - Haippy - 博客园_files/saved_resource.html"></iframe><div class="jiathis_style" style="height: auto; position: absolute; z-index: 100000000; display: none; top: 50%; left: 50%; overflow: auto;"><div style="border:10px solid #7F7F7F; width:300px;"><div class="jiadiv_01" style="width:300px;"><div style="background:#F2F2F2;line-height:100%;height:30px;overflow:hidden;width:300px;"><table width="100%" style="margin:5px 0 0 0;"><tbody><tr class="jt_sharetitle" style="line-height:20px!important;"><td align="left" style="text-align:left;font-size:12px;">分享到各大网站</td><td align="right"><img src="./C++11 并发指南四(_future_ 详解二 std__packaged_task 介绍) - Haippy - 博客园_files/img_exit.gif" border="0" style="margin:0 4px;cursor:pointer;" onclick="$CKE.centerClose();"></td></tr></tbody></table></div><div class="searchTxtCont"><div style="background:url(http://v2.jiathis.com/code/images/img_so.gif) no-repeat center;height:30px; width:281px"><form onsubmit="return false;"><input class="searchTxt" name="" type="text" onclick="this.value=&#39;&#39;;this.style.color=&#39;#000&#39;;" value="输入网站名或拼音缩写" onkeyup="$CKE.choose(this);"></form></div></div><div id="jiathis_sharelist" class="jiadiv_02" style="width:300px;height:300px;overflow-y:auto;"><a href="javascript:;" onclick="jiathis_sendto(&#39;weixin&#39;);return false;" class="jiatitle"><span class="jtico jtico_weixin">微信</span><input type="hidden" value="weixin,微信,wx"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;tsina&#39;);return false;" class="jiatitle"><span class="jtico jtico_tsina">微博</span><input type="hidden" value="tsina,微博,xlwb"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;cqq&#39;);return false;" class="jiatitle"><span class="jtico jtico_cqq">QQ好友</span><input type="hidden" value="cqq,QQ好友,cqq"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;qzone&#39;);return false;" class="jiatitle"><span class="jtico jtico_qzone">QQ空间</span><input type="hidden" value="qzone,QQ空间,qqkj"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;copy&#39;);return false;" class="jiatitle"><span class="jtico jtico_copy">复制网址</span><input type="hidden" value="copy,复制网址,fzwz"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;fav&#39;);return false;" class="jiatitle"><span class="jtico jtico_fav">收藏夹</span><input type="hidden" value="fav,收藏夹,scj"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;print&#39;);return false;" class="jiatitle"><span class="jtico jtico_print">打印</span><input type="hidden" value="print,打印,dy"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;email&#39;);return false;" class="jiatitle"><span class="jtico jtico_email">邮件</span><input type="hidden" value="email,邮件,yj"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;renren&#39;);return false;" class="jiatitle"><span class="jtico jtico_renren">人人网</span><input type="hidden" value="renren,人人网,rrw"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;kaixin001&#39;);return false;" class="jiatitle"><span class="jtico jtico_kaixin001">开心网</span><input type="hidden" value="kaixin001,开心网,kxw"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;evernote&#39;);return false;" class="jiatitle"><span class="jtico jtico_evernote">印象笔记</span><input type="hidden" value="evernote,印象笔记,evernote"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;linkedin&#39;);return false;" class="jiatitle"><span class="jtico jtico_linkedin">领英</span><input type="hidden" value="linkedin,领英,linkedin"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;feixin&#39;);return false;" class="jiatitle"><span class="jtico jtico_feixin">飞信</span><input type="hidden" value="feixin,飞信,fx"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;douban&#39;);return false;" class="jiatitle"><span class="jtico jtico_douban">豆瓣</span><input type="hidden" value="douban,豆瓣,db"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;twitter&#39;);return false;" class="jiatitle"><span class="jtico jtico_twitter">Twitter</span><input type="hidden" value="twitter,Twitter,twitter"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;fb&#39;);return false;" class="jiatitle"><span class="jtico jtico_fb">Facebook</span><input type="hidden" value="fb,Facebook,facebook"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;ishare&#39;);return false;" class="jiatitle"><span class="jtico jtico_ishare">一键分享</span><input type="hidden" value="ishare,一键分享,yjfx"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;ujian&#39;);return false;" class="jiatitle"><span class="jtico jtico_ujian">猜你喜欢</span><input type="hidden" value="ujian,猜你喜欢,cnxh"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;yixin&#39;);return false;" class="jiatitle"><span class="jtico jtico_yixin">易信</span><input type="hidden" value="yixin,易信,yx"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;huaban&#39;);return false;" class="jiatitle"><span class="jtico jtico_huaban">花瓣网</span><input type="hidden" value="huaban,花瓣网,hbw"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;tqq&#39;);return false;" class="jiatitle"><span class="jtico jtico_tqq">腾讯微博</span><input type="hidden" value="tqq,腾讯微博,txwb"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;googleplus&#39;);return false;" class="jiatitle"><span class="jtico jtico_googleplus">Google+</span><input type="hidden" value="googleplus,Google+,googlej"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;alibaba&#39;);return false;" class="jiatitle"><span class="jtico jtico_alibaba">阿里巴巴</span><input type="hidden" value="alibaba,阿里巴巴,albb"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;xiaoyou&#39;);return false;" class="jiatitle"><span class="jtico jtico_xiaoyou">朋友网</span><input type="hidden" value="xiaoyou,朋友网,pyw"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;sdonote&#39;);return false;" class="jiatitle"><span class="jtico jtico_sdonote">麦库记事</span><input type="hidden" value="sdonote,麦库记事,mkjs"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;baidu&#39;);return false;" class="jiatitle"><span class="jtico jtico_baidu">百度搜藏</span><input type="hidden" value="baidu,百度搜藏,bdsc"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;gmail&#39;);return false;" class="jiatitle"><span class="jtico jtico_gmail">Gmail邮箱</span><input type="hidden" value="gmail,Gmail邮箱,gmailyx"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;ydnote&#39;);return false;" class="jiatitle"><span class="jtico jtico_ydnote">有道云笔记</span><input type="hidden" value="ydnote,有道云笔记,ydybj"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;tianya&#39;);return false;" class="jiatitle"><span class="jtico jtico_tianya">天涯社区</span><input type="hidden" value="tianya,天涯社区,tysq"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;tieba&#39;);return false;" class="jiatitle"><span class="jtico jtico_tieba">百度贴吧</span><input type="hidden" value="tieba,百度贴吧,bdtb"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;qingbiji&#39;);return false;" class="jiatitle"><span class="jtico jtico_qingbiji">轻笔记</span><input type="hidden" value="qingbiji,轻笔记,qbj"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;tifeng&#39;);return false;" class="jiatitle"><span class="jtico jtico_tifeng">凤凰微博</span><input type="hidden" value="tifeng,凤凰微博,fhwb"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;fanfou&#39;);return false;" class="jiatitle"><span class="jtico jtico_fanfou">饭否</span><input type="hidden" value="fanfou,饭否,ff"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;mingdao&#39;);return false;" class="jiatitle"><span class="jtico jtico_mingdao">明道</span><input type="hidden" value="mingdao,明道,md"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;douban9dian&#39;);return false;" class="jiatitle"><span class="jtico jtico_douban9dian">豆瓣9点</span><input type="hidden" value="douban9dian,豆瓣9点,db9d"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;google&#39;);return false;" class="jiatitle"><span class="jtico jtico_google">谷歌</span><input type="hidden" value="google,谷歌,gg"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;buzz&#39;);return false;" class="jiatitle"><span class="jtico jtico_buzz">谷歌Buzz</span><input type="hidden" value="buzz,谷歌Buzz,ggbuzz"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;youdao&#39;);return false;" class="jiatitle"><span class="jtico jtico_youdao">有道书签</span><input type="hidden" value="youdao,有道书签,ydsq"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;qq&#39;);return false;" class="jiatitle"><span class="jtico jtico_qq">QQ书签</span><input type="hidden" value="qq,QQ书签,qqsq"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;msn&#39;);return false;" class="jiatitle"><span class="jtico jtico_msn">MSN</span><input type="hidden" value="msn,MSN,msn"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;pinterest&#39;);return false;" class="jiatitle"><span class="jtico jtico_pinterest">Pinterest</span><input type="hidden" value="pinterest,Pinterest,pinterest"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;duitang&#39;);return false;" class="jiatitle"><span class="jtico jtico_duitang">堆糖</span><input type="hidden" value="duitang,堆糖,dt"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;tyaolan&#39;);return false;" class="jiatitle"><span class="jtico jtico_tyaolan">摇篮微博</span><input type="hidden" value="tyaolan,摇篮微博,ylwb"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;hi&#39;);return false;" class="jiatitle"><span class="jtico jtico_hi">百度空间</span><input type="hidden" value="hi,百度空间,bdkj"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;hotmail&#39;);return false;" class="jiatitle"><span class="jtico jtico_hotmail">Hotmail邮箱</span><input type="hidden" value="hotmail,Hotmail邮箱,hotmailyx"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;xqw&#39;);return false;" class="jiatitle"><span class="jtico jtico_xqw">雪球</span><input type="hidden" value="xqw,雪球,xqw"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;hexun&#39;);return false;" class="jiatitle"><span class="jtico jtico_hexun">和讯</span><input type="hidden" value="hexun,和讯,hx"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;139mail&#39;);return false;" class="jiatitle"><span class="jtico jtico_139mail">139邮箱</span><input type="hidden" value="139mail,139邮箱,139yx"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;189mail&#39;);return false;" class="jiatitle"><span class="jtico jtico_189mail">189邮箱</span><input type="hidden" value="189mail,189邮箱,189yx"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;189cn&#39;);return false;" class="jiatitle"><span class="jtico jtico_189cn">翼友圈</span><input type="hidden" value="189cn,翼友圈,yyq"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;tpeople&#39;);return false;" class="jiatitle"><span class="jtico jtico_tpeople">人民微博</span><input type="hidden" value="tpeople,人民微博,rmwb"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;txinhua&#39;);return false;" class="jiatitle"><span class="jtico jtico_txinhua">新华微博</span><input type="hidden" value="txinhua,新华微博,xhwb"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;translate&#39;);return false;" class="jiatitle"><span class="jtico jtico_translate">谷歌翻译</span><input type="hidden" value="translate,谷歌翻译,ggfy"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;tuita&#39;);return false;" class="jiatitle"><span class="jtico jtico_tuita">推他</span><input type="hidden" value="tuita,推他,tt"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;mop&#39;);return false;" class="jiatitle"><span class="jtico jtico_mop">猫扑推客</span><input type="hidden" value="mop,猫扑推客,mptk"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;meilishuo&#39;);return false;" class="jiatitle"><span class="jtico jtico_meilishuo">美丽说</span><input type="hidden" value="meilishuo,美丽说,mls"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;mogujie&#39;);return false;" class="jiatitle"><span class="jtico jtico_mogujie">蘑菇街</span><input type="hidden" value="mogujie,蘑菇街,mgj"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;ganniu&#39;);return false;" class="jiatitle"><span class="jtico jtico_ganniu">赶牛网</span><input type="hidden" value="ganniu,赶牛网,gnw"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;poco&#39;);return false;" class="jiatitle"><span class="jtico jtico_poco">Poco网</span><input type="hidden" value="poco,Poco网,pocow"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;leihou&#39;);return false;" class="jiatitle"><span class="jtico jtico_leihou">雷猴网</span><input type="hidden" value="leihou,雷猴网,lhw"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;thexun&#39;);return false;" class="jiatitle"><span class="jtico jtico_thexun">和讯微博</span><input type="hidden" value="thexun,和讯微博,hxwb"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;dream163&#39;);return false;" class="jiatitle"><span class="jtico jtico_dream163">游戏江湖</span><input type="hidden" value="dream163,游戏江湖,yxjh"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;jcrb&#39;);return false;" class="jiatitle"><span class="jtico jtico_jcrb">法律微博</span><input type="hidden" value="jcrb,法律微博,flwb"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;tumblr&#39;);return false;" class="jiatitle"><span class="jtico jtico_tumblr">Tumblr</span><input type="hidden" value="tumblr,Tumblr,tumblr"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;reddit&#39;);return false;" class="jiatitle"><span class="jtico jtico_reddit">Reddit</span><input type="hidden" value="reddit,Reddit,reddit"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;instapaper&#39;);return false;" class="jiatitle"><span class="jtico jtico_instapaper">Instapaper</span><input type="hidden" value="instapaper,Instapaper,instapaper"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;pocket&#39;);return false;" class="jiatitle"><span class="jtico jtico_pocket">Pocket</span><input type="hidden" value="pocket,Pocket,pocket"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;caimi&#39;);return false;" class="jiatitle"><span class="jtico jtico_caimi">财迷</span><input type="hidden" value="caimi,财迷,cm"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;iwo&#39;);return false;" class="jiatitle"><span class="jtico jtico_iwo">WO+分享</span><input type="hidden" value="iwo,WO+分享,iwo"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;waakee&#39;);return false;" class="jiatitle"><span class="jtico jtico_waakee">挖客网</span><input type="hidden" value="waakee,挖客网,wkw"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;cyzone&#39;);return false;" class="jiatitle"><span class="jtico jtico_cyzone">创业邦</span><input type="hidden" value="cyzone,创业邦,cyb"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;99earth&#39;);return false;" class="jiatitle"><span class="jtico jtico_99earth">救救地球</span><input type="hidden" value="99earth,救救地球,jjdq"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;chouti&#39;);return false;" class="jiatitle"><span class="jtico jtico_chouti">抽屉网</span><input type="hidden" value="chouti,抽屉网,ctw"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;dig24&#39;);return false;" class="jiatitle"><span class="jtico jtico_dig24">递客网</span><input type="hidden" value="dig24,递客网,dkw"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;yijee&#39;);return false;" class="jiatitle"><span class="jtico jtico_yijee">易集网</span><input type="hidden" value="yijee,易集网,yjw"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;pdfonline&#39;);return false;" class="jiatitle"><span class="jtico jtico_pdfonline">Pdf在线转换</span><input type="hidden" value="pdfonline,Pdf在线转换,pdfzxzh"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;printfriendly&#39;);return false;" class="jiatitle"><span class="jtico jtico_printfriendly">友好打印</span><input type="hidden" value="printfriendly,友好打印,yhdy"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;w3c&#39;);return false;" class="jiatitle"><span class="jtico jtico_w3c">W3c验证</span><input type="hidden" value="w3c,W3c验证,w3cyz"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;bitly&#39;);return false;" class="jiatitle"><span class="jtico jtico_bitly">Bit.ly</span><input type="hidden" value="bitly,Bit.ly,bitly"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;digg&#39;);return false;" class="jiatitle"><span class="jtico jtico_digg">Digg</span><input type="hidden" value="digg,Digg,digg"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;mailru&#39;);return false;" class="jiatitle"><span class="jtico jtico_mailru">Mail.ru</span><input type="hidden" value="mailru,Mail.ru,mail.ru"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;diigo&#39;);return false;" class="jiatitle"><span class="jtico jtico_diigo">Diigo</span><input type="hidden" value="diigo,Diigo,diigo"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;friendfeed&#39;);return false;" class="jiatitle"><span class="jtico jtico_friendfeed">FriendFeed</span><input type="hidden" value="friendfeed,FriendFeed,friendfeed"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;myspace&#39;);return false;" class="jiatitle"><span class="jtico jtico_myspace">Myspace</span><input type="hidden" value="myspace,Myspace,myspace"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;mixx&#39;);return false;" class="jiatitle"><span class="jtico jtico_mixx">Mixx</span><input type="hidden" value="mixx,Mixx,mixx"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;netlog&#39;);return false;" class="jiatitle"><span class="jtico jtico_netlog">NetLog</span><input type="hidden" value="netlog,NetLog,netlog"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;netvibes&#39;);return false;" class="jiatitle"><span class="jtico jtico_netvibes">Netvibes</span><input type="hidden" value="netvibes,Netvibes,netvibes"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;phonefavs&#39;);return false;" class="jiatitle"><span class="jtico jtico_phonefavs">Phonefavs</span><input type="hidden" value="phonefavs,Phonefavs,phonefavs"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;pingfm&#39;);return false;" class="jiatitle"><span class="jtico jtico_pingfm">Ping.fm</span><input type="hidden" value="pingfm,Ping.fm,ping.fm"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;plaxo&#39;);return false;" class="jiatitle"><span class="jtico jtico_plaxo">Plaxo</span><input type="hidden" value="plaxo,Plaxo,plaxo"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;delicious&#39;);return false;" class="jiatitle"><span class="jtico jtico_delicious">Delicious</span><input type="hidden" value="delicious,Delicious,delicious"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;wong&#39;);return false;" class="jiatitle"><span class="jtico jtico_wong">Mister Wong</span><input type="hidden" value="wong,Mister Wong,misterwong"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;stumbleupon&#39;);return false;" class="jiatitle"><span class="jtico jtico_stumbleupon">Stumbleupon</span><input type="hidden" value="stumbleupon,Stumbleupon,stumbleupon"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;plurk&#39;);return false;" class="jiatitle"><span class="jtico jtico_plurk">Plurk</span><input type="hidden" value="plurk,Plurk,plurk"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;funp&#39;);return false;" class="jiatitle"><span class="jtico jtico_funp">Funp</span><input type="hidden" value="funp,Funp,funp"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;myshare&#39;);return false;" class="jiatitle"><span class="jtico jtico_myshare">Myshare</span><input type="hidden" value="myshare,Myshare,myshare"></a><div style="clear:both"></div></div><div class="centerBottom"><div style="float:left;font-size:10px;"><a href="http://www.jiathis.com/help/html/what-is-jiathis" class="link_01" style="color:#333333;display:none;" target="_blank">这是什么工具?</a></div><div style="float:right;font-size:11px;margin:0 10px 0 0;"><img src="./C++11 并发指南四(_future_ 详解二 std__packaged_task 介绍) - Haippy - 博客园_files/img_012.gif" align="absmiddle" border="none">&nbsp;<a href="http://www.jiathis.com/index2" style="color:#333333;" class="link_01" target="_blank">JiaThis</a></div><div style="clear:both"></div></div></div></div></div><iframe frameborder="0" src="./C++11 并发指南四(_future_ 详解二 std__packaged_task 介绍) - Haippy - 博客园_files/jiathis_utility.html" style="display: none;"></iframe>
<a name="top"></a>


<div id="container">
    <a class="minyx" href="http://www.cnblogs.com/">代码改变世界</a>
    <ul id="topMnu">
        <!-- 统计数据 -->
        <li>
            
                <div id="blog_stats">
Posts - 110, 
Articles - 2, 
Comments - 191
<!----></div>
            
        </li>
        <!-- 这边可以增加一些链接 -->
        <!-- 博客园 -->
        <li><a href="http://www.cnblogs.com/">Cnblogs</a></li>
        <!-- 管理 -->
        <li id="topMnu-dashboard">
            <a id="lnkDashboard" href="http://www.cnblogs.com/haippy/admin/EditPosts.aspx">Dashboard</a></li>
        <li>
            <a id="lnkLogin" href="http://passport.cnblogs.com/logout.aspx?ReturnUrl=http://www.cnblogs.com/haippy/p/3279565.html">Logout</a></li>
    </ul>

    <script type="text/javascript">
        var m = window.__blog.topMenuRendered;
        if (m) { m(__$("topMnu")); }
    </script>

    <div id="header">
        <ul id="menu">
            <!-- 首页，当前section加上current类 -->
            <li id="menu-home" class="current">
                <a id="lnkHome" href="http://www.cnblogs.com/haippy/">Home</a></li>
            <!-- 联系 -->
            <li id="menu-contact">
                <a id="lnkContact" href="http://space.cnblogs.com/msg/send/Haippy">Contact</a></li>
            <!-- 相册 -->
            <li id="menu-gallary">
                <a id="lnkGallery" href="http://www.cnblogs.com/haippy/gallery.html">Gallery</a></li>
            <!-- Rss订阅 -->
            <li id="rss">
                <a id="lnkRss" href="http://www.cnblogs.com/haippy/rss">RSS</a></li>
        </ul>
        <div id="newmsg"></div>
        <h1>
            <!-- 主标题 -->
            <a id="lnkBlogTitle" href="http://www.cnblogs.com/haippy/">256code, 生活与技术</a>
            <!-- 子标题 -->
            <small>
                </small>
        </h1>
    </div>

    <script type="text/javascript">
        var m = window.__blog.headerRendered;
        if (m) { m(__$("header")); }
    </script>

    <div id="wrapper">
        <div id="content">
            <script type="text/javascript">
                var m = window.__blog.preRenderPosts;
                if (m) { m(); }
            </script>
            
<div id="post_detail">
<div class="post" id="post">
    <a name="top"></a>
    <h2><a id="cb_post_title_url" href="http://www.cnblogs.com/haippy/p/3279565.html">C++11 并发指南四(&lt;future&gt; 详解二 std::packaged_task 介绍)</a></h2>
    <small>2013-08-24 22:20 by Haippy, <span id="post_view_count">9316</span> 阅读, <span id="post_comment_count">10</span> 评论, <a href="http://www.cnblogs.com/haippy/p/3279565.html#" onclick="AddToWz(3279565);return false;">收藏</a>,  <a href="https://i.cnblogs.com/EditPosts.aspx?postid=3279565" rel="nofollow">编辑</a></small>
    <div class="entry">
        <div id="cnblogs_post_body"><p>上一讲《<a href="http://www.cnblogs.com/haippy/p/3239248.html" target="_blank">C++11 并发指南四(&lt;future&gt; 详解一 std::promise 介绍)</a>》主要介绍了 &lt;future&gt; 头文件中的 std::promise 类，本文主要介绍 <span class="namespace" title="namespace std">std::</span>packaged_task。</p>
<p>std::packaged_task 包装一个可调用的对象，并且允许异步获取该可调用对象产生的结果，从包装可调用对象意义上来讲，std::packaged_task 与 std::function 类似，只不过 std::packaged_task 将其包装的可调用对象的执行结果传递给一个 std::future 对象（该对象通常在另外一个线程中获取 std::packaged_task 任务的执行结果）。</p>
<p>std::packaged_task 对象内部包含了两个最基本元素，一、被包装的任务(stored task)，任务(task)是一个可调用的对象，如函数指针、成员函数指针或者函数对象，二、共享状态(shared state)，用于保存任务的返回值，可以通过 std::future 对象来达到异步访问共享状态的效果。</p>
<p>可以通过 std::packged_task::get_future 来获取与共享状态相关联的 std::future 对象。在调用该函数之后，两个对象共享相同的共享状态，具体解释如下：</p>
<ul>
<li>std::packaged_task 对象是异步 Provider，它在某一时刻通过调用被包装的任务来设置共享状态的值。</li>
<li>std::future 对象是一个异步返回对象，通过它可以获得共享状态的值，当然在必要的时候需要等待共享状态标志变为 ready.</li>
</ul>
<p>std::packaged_task 的共享状态的生命周期一直持续到最后一个与之相关联的对象被释放或者销毁为止。下面一个小例子大致讲了 std::packaged_task 的用法：</p>
<div class="cnblogs_code"><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./C++11 并发指南四(_future_ 详解二 std__packaged_task 介绍) - Haippy - 博客园_files/copycode.gif" alt="复制代码"></a></span></div>
<pre>#include &lt;iostream&gt;     <span style="color: #008000;">//</span><span style="color: #008000;"> std::cout</span>
#include &lt;future&gt;       <span style="color: #008000;">//</span><span style="color: #008000;"> std::packaged_task, std::future</span>
#include &lt;chrono&gt;       <span style="color: #008000;">//</span><span style="color: #008000;"> std::chrono::seconds</span>
#include &lt;thread&gt;       <span style="color: #008000;">//</span><span style="color: #008000;"> std::thread, std::this_thread::sleep_for

</span><span style="color: #008000;">//</span><span style="color: #008000;"> count down taking a second for each value:</span>
<span style="color: #0000ff;">int</span> countdown (<span style="color: #0000ff;">int</span> <span style="color: #0000ff;">from</span>, <span style="color: #0000ff;">int</span><span style="color: #000000;"> to) {
    </span><span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">int</span> i=<span style="color: #0000ff;">from</span>; i!=to; --<span style="color: #000000;">i) {
        std::cout </span>&lt;&lt; i &lt;&lt; <span style="color: #800000;">'</span><span style="color: #800000;">\n</span><span style="color: #800000;">'</span><span style="color: #000000;">;
        std::this_thread::sleep_for(std::chrono::seconds(</span><span style="color: #800080;">1</span><span style="color: #000000;">));
    }
    std::cout </span>&lt;&lt; <span style="color: #800000;">"</span><span style="color: #800000;">Finished!\n</span><span style="color: #800000;">"</span><span style="color: #000000;">;
    </span><span style="color: #0000ff;">return</span> <span style="color: #0000ff;">from</span> -<span style="color: #000000;"> to;
}

</span><span style="color: #0000ff;">int</span><span style="color: #000000;"> main ()
{
    std::packaged_task</span>&lt;<span style="color: #0000ff;">int</span>(<span style="color: #0000ff;">int</span>,<span style="color: #0000ff;">int</span>)&gt; task(countdown); <span style="color: #008000;">//</span><span style="color: #008000;"> 设置 packaged_task</span>
    std::future&lt;<span style="color: #0000ff;">int</span>&gt; ret = task.get_future(); <span style="color: #008000;">//</span><span style="color: #008000;"> 获得与 packaged_task 共享状态相关联的 future 对象.</span>
<span style="color: #000000;">
    std::thread th(std::move(task), </span><span style="color: #800080;">10</span>, <span style="color: #800080;">0</span>);   <span style="color: #008000;">//</span><span style="color: #008000;">创建一个新线程完成计数任务.</span>

    <span style="color: #0000ff;">int</span> value = ret.<span style="color: #0000ff;">get</span>();                    <span style="color: #008000;">//</span><span style="color: #008000;"> 等待任务完成并获取结果.</span>
<span style="color: #000000;">
    std::cout </span>&lt;&lt; <span style="color: #800000;">"</span><span style="color: #800000;">The countdown lasted for </span><span style="color: #800000;">"</span> &lt;&lt; value &lt;&lt; <span style="color: #800000;">"</span><span style="color: #800000;"> seconds.\n</span><span style="color: #800000;">"</span><span style="color: #000000;">;

    th.join();
    </span><span style="color: #0000ff;">return</span> <span style="color: #800080;">0</span><span style="color: #000000;">;
}</span></pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./C++11 并发指南四(_future_ 详解二 std__packaged_task 介绍) - Haippy - 博客园_files/copycode.gif" alt="复制代码"></a></span></div></div>
<p>执行结果为：</p>
<div class="cnblogs_code"><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./C++11 并发指南四(_future_ 详解二 std__packaged_task 介绍) - Haippy - 博客园_files/copycode.gif" alt="复制代码"></a></span></div>
<pre>concurrency ) ./<span style="color: #000000;">Packaged_Task1 
</span><span style="color: #800080;">10</span>
<span style="color: #800080;">9</span>
<span style="color: #800080;">8</span>
<span style="color: #800080;">7</span>
<span style="color: #800080;">6</span>
<span style="color: #800080;">5</span>
<span style="color: #800080;">4</span>
<span style="color: #800080;">3</span>
<span style="color: #800080;">2</span>
<span style="color: #800080;">1</span><span style="color: #000000;">
Finished</span>!<span style="color: #000000;">
The countdown lasted </span><span style="color: #0000ff;">for</span> <span style="color: #800080;">10</span><span style="color: #000000;"> seconds.
</span></pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./C++11 并发指南四(_future_ 详解二 std__packaged_task 介绍) - Haippy - 博客园_files/copycode.gif" alt="复制代码"></a></span></div></div>
<p><strong>std::packaged_task 构造函数</strong></p>
<table>
<tbody>
<tr class="odd"><th>default (1)</th>
<td>
<pre>packaged_task() noexcept;
</pre>
</td>
</tr>
<tr class="even"><th>initialization (2)</th>
<td>
<pre>template &lt;class Fn&gt;
  explicit packaged_task (Fn&amp;&amp; fn);
</pre>
</td>
</tr>
<tr class="odd"><th>with allocator (3)</th>
<td>
<pre>template &lt;class Fn, class Alloc&gt;
  explicit packaged_task (allocator_arg_t aa, const Alloc&amp; alloc, Fn&amp;&amp; fn);
</pre>
</td>
</tr>
<tr class="even"><th>copy [deleted] (4)</th>
<td>
<pre>packaged_task (const packaged_task&amp;) = delete;
</pre>
</td>
</tr>
<tr class="odd"><th>move (5)</th>
<td>
<pre>packaged_task (packaged_task&amp;&amp; x) noexcept;</pre>
</td>
</tr>
</tbody>
</table>
<p>std::packaged_task 构造函数共有 5 中形式，不过拷贝构造已经被禁用了。下面简单地介绍一下上述几种构造函数的语义：</p>
<ol>
<li>默认构造函数，初始化一个空的共享状态，并且该 packaged_task 对象无包装任务。</li>
<li>初始化一个共享状态，并且被包装任务由参数 fn 指定。</li>
<li>带自定义内存分配器的构造函数，与默认构造函数类似，但是使用自定义分配器来分配共享状态。</li>
<li>拷贝构造函数，被禁用。</li>
<li>移动构造函数。</li>
</ol>
<p>下面例子介绍了各类构造函数的用法：</p>
<div class="cnblogs_code"><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./C++11 并发指南四(_future_ 详解二 std__packaged_task 介绍) - Haippy - 博客园_files/copycode.gif" alt="复制代码"></a></span></div>
<pre>#include &lt;iostream&gt;     <span style="color: #008000;">//</span><span style="color: #008000;"> std::cout</span>
#include &lt;utility&gt;      <span style="color: #008000;">//</span><span style="color: #008000;"> std::move</span>
#include &lt;future&gt;       <span style="color: #008000;">//</span><span style="color: #008000;"> std::packaged_task, std::future</span>
#include &lt;thread&gt;       <span style="color: #008000;">//</span><span style="color: #008000;"> std::thread</span>

<span style="color: #0000ff;">int</span><span style="color: #000000;"> main ()
{
    std::packaged_task</span>&lt;<span style="color: #0000ff;">int</span>(<span style="color: #0000ff;">int</span>)&gt; foo; <span style="color: #008000;">//</span><span style="color: #008000;"> 默认构造函数.

    </span><span style="color: #008000;">//</span><span style="color: #008000;"> 使用 lambda 表达式初始化一个 packaged_task 对象.</span>
    std::packaged_task&lt;<span style="color: #0000ff;">int</span>(<span style="color: #0000ff;">int</span>)&gt; bar([](<span style="color: #0000ff;">int</span> x){<span style="color: #0000ff;">return</span> x*<span style="color: #800080;">2</span><span style="color: #000000;">;});

    foo </span>= std::move(bar); <span style="color: #008000;">//</span><span style="color: #008000;"> move-赋值操作，也是 C++11 中的新特性.

    </span><span style="color: #008000;">//</span><span style="color: #008000;"> 获取与 packaged_task 共享状态相关联的 future 对象.</span>
    std::future&lt;<span style="color: #0000ff;">int</span>&gt; ret =<span style="color: #000000;"> foo.get_future();

    std::thread(std::move(foo), </span><span style="color: #800080;">10</span>).detach(); <span style="color: #008000;">//</span><span style="color: #008000;"> 产生线程，调用被包装的任务.</span>

    <span style="color: #0000ff;">int</span> value = ret.<span style="color: #0000ff;">get</span>(); <span style="color: #008000;">//</span><span style="color: #008000;"> 等待任务完成并获取结果.</span>
    std::cout &lt;&lt; <span style="color: #800000;">"</span><span style="color: #800000;">The double of 10 is </span><span style="color: #800000;">"</span> &lt;&lt; value &lt;&lt; <span style="color: #800000;">"</span><span style="color: #800000;">.\n</span><span style="color: #800000;">"</span><span style="color: #000000;">;

</span><span style="color: #0000ff;">return</span> <span style="color: #800080;">0</span><span style="color: #000000;">;
}</span></pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./C++11 并发指南四(_future_ 详解二 std__packaged_task 介绍) - Haippy - 博客园_files/copycode.gif" alt="复制代码"></a></span></div></div>
<p>与 std::promise 类似， std::packaged_task 也禁用了普通的赋值操作运算，只允许 move 赋值运算。</p>
<p><strong>std::packaged_task::valid 介绍</strong></p>
<p>检查当前 packaged_task 是否和一个有效的共享状态相关联，对于由默认构造函数生成的 packaged_task 对象，该函数返回 false，除非中间进行了 move 赋值操作或者 swap 操作。</p>
<p>请看下例：</p>
<div class="cnblogs_code"><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./C++11 并发指南四(_future_ 详解二 std__packaged_task 介绍) - Haippy - 博客园_files/copycode.gif" alt="复制代码"></a></span></div>
<pre>#include &lt;iostream&gt;     <span style="color: #008000;">//</span><span style="color: #008000;"> std::cout</span>
#include &lt;utility&gt;      <span style="color: #008000;">//</span><span style="color: #008000;"> std::move</span>
#include &lt;future&gt;       <span style="color: #008000;">//</span><span style="color: #008000;"> std::packaged_task, std::future</span>
#include &lt;thread&gt;       <span style="color: #008000;">//</span><span style="color: #008000;"> std::thread

</span><span style="color: #008000;">//</span><span style="color: #008000;"> 在新线程中启动一个 int(int) packaged_task.</span>
std::future&lt;<span style="color: #0000ff;">int</span>&gt; launcher(std::packaged_task&lt;<span style="color: #0000ff;">int</span>(<span style="color: #0000ff;">int</span>)&gt;&amp; tsk, <span style="color: #0000ff;">int</span><span style="color: #000000;"> arg)
{
    </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> (tsk.valid()) {
        std::future</span>&lt;<span style="color: #0000ff;">int</span>&gt; ret =<span style="color: #000000;"> tsk.get_future();
        std::thread (std::move(tsk),arg).detach();
        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> ret;
    }
    </span><span style="color: #0000ff;">else</span> <span style="color: #0000ff;">return</span> std::future&lt;<span style="color: #0000ff;">int</span>&gt;<span style="color: #000000;">();
}

</span><span style="color: #0000ff;">int</span><span style="color: #000000;"> main ()
{
    std::packaged_task</span>&lt;<span style="color: #0000ff;">int</span>(<span style="color: #0000ff;">int</span>)&gt; tsk([](<span style="color: #0000ff;">int</span> x){<span style="color: #0000ff;">return</span> x*<span style="color: #800080;">2</span><span style="color: #000000;">;});

    std::future</span>&lt;<span style="color: #0000ff;">int</span>&gt; fut = launcher(tsk,<span style="color: #800080;">25</span><span style="color: #000000;">);

    std::cout </span>&lt;&lt; <span style="color: #800000;">"</span><span style="color: #800000;">The double of 25 is </span><span style="color: #800000;">"</span> &lt;&lt; fut.<span style="color: #0000ff;">get</span>() &lt;&lt; <span style="color: #800000;">"</span><span style="color: #800000;">.\n</span><span style="color: #800000;">"</span><span style="color: #000000;">;

    </span><span style="color: #0000ff;">return</span> <span style="color: #800080;">0</span><span style="color: #000000;">;
}</span></pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./C++11 并发指南四(_future_ 详解二 std__packaged_task 介绍) - Haippy - 博客园_files/copycode.gif" alt="复制代码"></a></span></div></div>
<p><strong>std::packaged_task::get_future 介绍</strong></p>
<p>返回一个与 packaged_task 对象共享状态相关的 future 对象。返回的 future 对象可以获得由另外一个线程在该 packaged_task 对象的共享状态上设置的某个值或者异常。</p>
<p>请看例子(其实前面已经讲了 get_future 的例子)：</p>
<div class="cnblogs_code"><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./C++11 并发指南四(_future_ 详解二 std__packaged_task 介绍) - Haippy - 博客园_files/copycode.gif" alt="复制代码"></a></span></div>
<pre>#include &lt;iostream&gt;     <span style="color: #008000;">//</span><span style="color: #008000;"> std::cout</span>
#include &lt;utility&gt;      <span style="color: #008000;">//</span><span style="color: #008000;"> std::move</span>
#include &lt;future&gt;       <span style="color: #008000;">//</span><span style="color: #008000;"> std::packaged_task, std::future</span>
#include &lt;thread&gt;       <span style="color: #008000;">//</span><span style="color: #008000;"> std::thread</span>

<span style="color: #0000ff;">int</span><span style="color: #000000;"> main ()
{
    std::packaged_task</span>&lt;<span style="color: #0000ff;">int</span>(<span style="color: #0000ff;">int</span>)&gt; tsk([](<span style="color: #0000ff;">int</span> x) { <span style="color: #0000ff;">return</span> x * <span style="color: #800080;">3</span>; })); <span style="color: #008000;">//</span><span style="color: #008000;"> package task</span>
<span style="color: #000000;">
    std::future</span>&lt;<span style="color: #0000ff;">int</span>&gt; fut = tsk.get_future();   <span style="color: #008000;">//</span><span style="color: #008000;"> 获取 future 对象.</span>
<span style="color: #000000;">
    std::thread(std::move(tsk), </span><span style="color: #800080;">100</span>).detach();   <span style="color: #008000;">//</span><span style="color: #008000;"> 生成新线程并调用packaged_task.</span>

    <span style="color: #0000ff;">int</span> value = fut.<span style="color: #0000ff;">get</span>();                     <span style="color: #008000;">//</span><span style="color: #008000;"> 等待任务完成, 并获取结果.</span>
<span style="color: #000000;">
    std::cout </span>&lt;&lt; <span style="color: #800000;">"</span><span style="color: #800000;">The triple of 100 is </span><span style="color: #800000;">"</span> &lt;&lt; value &lt;&lt; <span style="color: #800000;">"</span><span style="color: #800000;">.\n</span><span style="color: #800000;">"</span><span style="color: #000000;">;

    </span><span style="color: #0000ff;">return</span> <span style="color: #800080;">0</span><span style="color: #000000;">;
}</span></pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./C++11 并发指南四(_future_ 详解二 std__packaged_task 介绍) - Haippy - 博客园_files/copycode.gif" alt="复制代码"></a></span></div></div>
<p><strong>std::packaged_task::operator()(Args... args) 介绍</strong></p>
<p>调用该 packaged_task 对象所包装的对象(通常为函数指针，函数对象，lambda 表达式等)，传入的参数为 args. 调用该函数一般会发生两种情况：</p>
<ul>
<li>如果成功调用 packaged_task 所包装的对象，则返回值（如果被包装的对象有返回值的话）被保存在 packaged_task 的共享状态中。</li>
<li>如果调用 packaged_task 所包装的对象失败，并且抛出了异常，则异常也会被保存在 packaged_task 的共享状态中。</li>
</ul>
<p>以上两种情况都使共享状态的标志变为 ready，因此其他等待该共享状态的线程可以获取共享状态的值或者异常并继续执行下去。</p>
<p>共享状态的值可以通过在 future 对象(由 get_future获得)上调用 get 来获得。</p>
<p>由于被包装的任务在 packaged_task 构造时指定，因此调用 operator() 的效果由 packaged_task 对象构造时所指定的可调用对象来决定：</p>
<ul>
<li>如果被包装的任务是函数指针或者函数对象，调用 std::packaged_task::operator() 只是将参数传递给被包装的对象。</li>
<li>如果被包装的任务是指向类的非静态成员函数的指针，那么 std::packaged_task::operator() 的第一个参数应该指定为成员函数被调用的那个对象，剩余的参数作为该成员函数的参数。</li>
<li>如果被包装的任务是指向类的非静态成员变量，那么 std::packaged_task::operator() 只允许单个参数。</li>
</ul>
<p><strong><span class="namespace" title="namespace std">std::</span>packaged_task::make_ready_at_thread_exit 介绍</strong></p>
<p>该函数会调用被包装的任务，并向任务传递参数，类似 std::packaged_task 的 operator() 成员函数。<samp>但是与 operator() 函数不同的是，make_ready_at_thread_exit 并不会立即设置共享状态的标志为 ready，而是在线程退出时设置共享状态的标志。</samp></p>
<p>如果与该 packaged_task 共享状态相关联的 future 对象在 future::get 处等待，则当前的 future::get 调用会被阻塞，直到线程退出。而一旦线程退出，future::get 调用继续执行，或者抛出异常。<br>
<br>
注意，该函数已经设置了 promise 共享状态的值，如果在线程结束之前有其他设置或者修改共享状态的值的操作，则会抛出 future_error<samp>( promise_already_satisfied )。</samp></p>
<p><strong>std::packaged_task::reset() 介绍</strong></p>
<p>重置 packaged_task 的共享状态，但是保留之前的被包装的任务。请看例子，该例子中，packaged_task 被重用了多次：</p>
<div class="cnblogs_code"><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./C++11 并发指南四(_future_ 详解二 std__packaged_task 介绍) - Haippy - 博客园_files/copycode.gif" alt="复制代码"></a></span></div>
<pre>#include &lt;iostream&gt;     <span style="color: #008000;">//</span><span style="color: #008000;"> std::cout</span>
#include &lt;utility&gt;      <span style="color: #008000;">//</span><span style="color: #008000;"> std::move</span>
#include &lt;future&gt;       <span style="color: #008000;">//</span><span style="color: #008000;"> std::packaged_task, std::future</span>
#include &lt;thread&gt;       <span style="color: #008000;">//</span><span style="color: #008000;"> std::thread

</span><span style="color: #008000;">//</span><span style="color: #008000;"> a simple task:</span>
<span style="color: #0000ff;">int</span> triple (<span style="color: #0000ff;">int</span> x) { <span style="color: #0000ff;">return</span> x*<span style="color: #800080;">3</span><span style="color: #000000;">; }

</span><span style="color: #0000ff;">int</span><span style="color: #000000;"> main ()
{
    std::packaged_task</span>&lt;<span style="color: #0000ff;">int</span>(<span style="color: #0000ff;">int</span>)&gt; tsk (triple); <span style="color: #008000;">//</span><span style="color: #008000;"> package task</span>
<span style="color: #000000;">

    std::future</span>&lt;<span style="color: #0000ff;">int</span>&gt; fut =<span style="color: #000000;"> tsk.get_future();
    std::thread (std::move(tsk), </span><span style="color: #800080;">100</span><span style="color: #000000;">).detach();
    std::cout </span>&lt;&lt; <span style="color: #800000;">"</span><span style="color: #800000;">The triple of 100 is </span><span style="color: #800000;">"</span> &lt;&lt; fut.<span style="color: #0000ff;">get</span>() &lt;&lt; <span style="color: #800000;">"</span><span style="color: #800000;">.\n</span><span style="color: #800000;">"</span><span style="color: #000000;">;


    </span><span style="color: #008000;">//</span><span style="color: #008000;"> re-use same task object:</span>
<span style="color: #000000;">    tsk.reset();
    fut </span>=<span style="color: #000000;"> tsk.get_future();
    std::thread(std::move(tsk), </span><span style="color: #800080;">200</span><span style="color: #000000;">).detach();
    std::cout </span>&lt;&lt; <span style="color: #800000;">"</span><span style="color: #800000;">Thre triple of 200 is </span><span style="color: #800000;">"</span> &lt;&lt; fut.<span style="color: #0000ff;">get</span>() &lt;&lt; <span style="color: #800000;">"</span><span style="color: #800000;">.\n</span><span style="color: #800000;">"</span><span style="color: #000000;">;

    </span><span style="color: #0000ff;">return</span> <span style="color: #800080;">0</span><span style="color: #000000;">;
}</span></pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./C++11 并发指南四(_future_ 详解二 std__packaged_task 介绍) - Haippy - 博客园_files/copycode.gif" alt="复制代码"></a></span></div></div>
<p><strong>std::packaged_task::swap() 介绍</strong></p>
<p>交换 packaged_task 的共享状态。</p>
<p>好了，std::packaged_task 介绍到这里，本文参考了 <a href="http://www.cplusplus.com/reference/future/packaged_task/" target="_blank">http://www.cplusplus.com/reference/future/packaged_task/</a> 相关的内容。后一篇文章我将向大家介绍 std::future，std::shared_future 以及 std::future_error，另外还会介绍 &lt;future&gt; 头文件中的 std::async，std::future_category 函数以及相关枚举类型。</p></div><div id="MySignature"></div>
        <div class="clear"></div>
        <div id="blog_post_info_block">
        <div id="blog_post_info"><div id="green_channel">
        <a href="javascript:void(0);" id="green_channel_digg" onclick="DiggIt(3279565,cb_blogId,1);green_channel_success(this,&#39;谢谢推荐！&#39;);">好文要顶</a>
            <a id="green_channel_follow" href="javascript:void(0);">已关注</a>
    <a id="green_channel_favorite" onclick="AddToWz(cb_entryId);return false;" href="javascript:void(0);">收藏该文</a>
    <a id="green_channel_weibo" href="javascript:void(0);" title="分享至新浪微博" onclick="ShareToTsina()"><img src="./C++11 并发指南四(_future_ 详解二 std__packaged_task 介绍) - Haippy - 博客园_files/icon_weibo_24.png" alt=""></a>
    <a id="green_channel_wechat" href="javascript:void(0);" title="分享至微信" onclick="shareOnWechat()"><img src="./C++11 并发指南四(_future_ 详解二 std__packaged_task 介绍) - Haippy - 博客园_files/wechat.png" alt=""></a>
</div>
<div id="author_profile">
    <div id="author_profile_info" class="author_profile_info">
            <a href="http://home.cnblogs.com/u/haippy/" target="_blank"><img src="./C++11 并发指南四(_future_ 详解二 std__packaged_task 介绍) - Haippy - 博客园_files/u274814.png" class="author_avatar" alt=""></a>
        <div id="author_profile_detail" class="author_profile_info">
            <a href="http://home.cnblogs.com/u/haippy/">Haippy</a><br>
            <a href="http://home.cnblogs.com/u/haippy/followees">关注 - 37</a><br>
            <a href="http://home.cnblogs.com/u/haippy/followers">粉丝 - 447</a>
        </div>
    </div>
    <div class="clear"></div>
    <div id="author_profile_honor"></div>
    <div id="author_profile_follow">
                我在关注他 <a href="javascript:void(0);" onclick="unfollow(&#39;bcaec1c6-ed3b-e011-ac81-842b2b196315&#39;);return false;">取消关注</a>
    </div>
</div>
<div id="div_digg">
    <div class="diggit" onclick="votePost(3279565,&#39;Digg&#39;)">
        <span class="diggnum" id="digg_count">1</span>
    </div>
    <div class="buryit" onclick="votePost(3279565,&#39;Bury&#39;)">
        <span class="burynum" id="bury_count">0</span>
    </div>
    <div class="clear"></div>
    <div class="diggword" id="digg_tips">
    </div>
</div>
</div>
        <div class="clear"></div>
        <div id="post_next_prev"><a href="http://www.cnblogs.com/haippy/p/3239248.html" class="p_n_p_prefix">« </a> 上一篇：<a href="http://www.cnblogs.com/haippy/p/3239248.html" title="发布于2013-08-24 12:20">C++11 并发指南四(&lt;future&gt; 详解一 std::promise 介绍)</a><br><a href="http://www.cnblogs.com/haippy/p/3280643.html" class="p_n_p_prefix">» </a> 下一篇：<a href="http://www.cnblogs.com/haippy/p/3280643.html" title="发布于2013-08-27 10:55">C++11 并发指南四(&lt;future&gt; 详解三 std::future &amp; std::shared_future)</a><br></div>
    </div>
</div>
    <ul class="postmetadata">
        <li class="icon_cat" id="BlogPostCategory">分类: <a href="http://www.cnblogs.com/haippy/category/381853.html" target="_blank">C &amp; C++</a>,<a href="http://www.cnblogs.com/haippy/category/505027.html" target="_blank">C++11</a></li>
        <li class="icon_bullet" id="EntryTag">标签: <a href="http://www.cnblogs.com/haippy/tag/C%2B%2B11/">C++11</a>, <a href="http://www.cnblogs.com/haippy/tag/multithreading/">multithreading</a>, <a href="http://www.cnblogs.com/haippy/tag/%E5%A4%9A%E7%BA%BF%E7%A8%8B/">多线程</a></li>
    </ul>
</div>
<script type="text/javascript">var allowComments=true,cb_blogId=97212,cb_entryId=3279565,cb_blogApp=currentBlogApp,cb_blogUserGuid='bcaec1c6-ed3b-e011-ac81-842b2b196315',cb_entryCreatedDate='2013/8/24 22:20:00';loadViewCount(cb_entryId);</script>
<script type="text/javascript">
    var m = window.__blog.postRendered;
    if (m) { m(__$("post")); }
</script>
<script type="text/javascript">
    var m = window.__blog.postRenderPosts;
    if (m) { m(); }
</script>
</div><a name="!comments"></a><div id="blog-comments-placeholder"><div id="comments_pager_top"></div>
<a class="addcomment" href="http://www.cnblogs.com/haippy/p/3279565.html#comment_tip">Add your comment</a>
<h3 id="comments"></h3>
<div class="feedbackNoItems"></div>


<ol class="commentlist" id="commentList">	

		<li class="alt">
			<h5>
				<cite><a href="http://www.cnblogs.com/haippy/p/3279565.html#2978490" class="layer">#1楼</a><a name="2978490" id="comment_anchor_2978490"></a></cite> <a id="a_comment_author_2978490" href="http://home.cnblogs.com/u/648540/" target="_blank">sssaa</a> <a href="http://msg.cnblogs.com/send/sssaa" title="发送站内短消息" class="sendMsg2This">&nbsp;</a><small> <span class="comment_date">2014-07-07 10:53</span></small>
			</h5>
			<div id="comment_body_2978490" class="blog_comment_body">最后一个程序用vs2013 运行时出错，能麻烦楼主解释一下吗？</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(2978490,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(2978490,&#39;Bury&#39;,this)">反对(0)</a></div>
			<div class="opt_comment"><span class="comment_actions"><a href="javascript:void(0);" onclick="return ReplyComment(2978490,&#39;qdRF+YZS2fPdrQisu586kpFw1F0GSG0wyk53w8O4dFrCs/YkpFa5yA==&#39;)">回复</a><a href="javascript:void(0);" onclick="return QuoteComment(2978490,&#39;qdRF+YZS2fPdrQisu586kpFw1F0GSG0wyk53w8O4dFrCs/YkpFa5yA==&#39;)">引用</a></span></div>
		</li>
	
		<li class="alt">
			<h5>
				<cite><a href="http://www.cnblogs.com/haippy/p/3279565.html#2978493" class="layer">#2楼</a><a name="2978493" id="comment_anchor_2978493"></a></cite> <a id="a_comment_author_2978493" href="http://home.cnblogs.com/u/648540/" target="_blank">sssaa</a> <a href="http://msg.cnblogs.com/send/sssaa" title="发送站内短消息" class="sendMsg2This">&nbsp;</a><small> <span class="comment_date">2014-07-07 11:00</span></small>
			</h5>
			<div id="comment_body_2978493" class="blog_comment_body">找到了  是move::tsk的原因</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(2978493,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(2978493,&#39;Bury&#39;,this)">反对(0)</a></div>
			<div class="opt_comment"><span class="comment_actions"><a href="javascript:void(0);" onclick="return ReplyComment(2978493,&#39;qdRF+YZS2fPdrQisu586kpFw1F0GSG0wyk53w8O4dFrCs/YkpFa5yA==&#39;)">回复</a><a href="javascript:void(0);" onclick="return QuoteComment(2978493,&#39;qdRF+YZS2fPdrQisu586kpFw1F0GSG0wyk53w8O4dFrCs/YkpFa5yA==&#39;)">引用</a></span></div>
		</li>
	
		<li class="alt">
			<h5>
				<cite><a href="http://www.cnblogs.com/haippy/p/3279565.html#3048876" class="layer">#3楼</a><a name="3048876" id="comment_anchor_3048876"></a></cite> <a id="a_comment_author_3048876" href="http://home.cnblogs.com/u/684315/" target="_blank">玄炎</a> <a href="http://msg.cnblogs.com/send/%E7%8E%84%E7%82%8E" title="发送站内短消息" class="sendMsg2This">&nbsp;</a><small> <span class="comment_date">2014-10-22 15:06</span></small>
			</h5>
			<div id="comment_body_3048876" class="blog_comment_body">膜拜一下学长，居然能看到了直系学长的技术分享</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3048876,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3048876,&#39;Bury&#39;,this)">反对(0)</a></div>
			<div class="opt_comment"><span class="comment_actions"><a href="javascript:void(0);" onclick="return ReplyComment(3048876,&#39;vs3M1BMM5nBJBtUIcGABVoLnuhQl5tnL+JkLIg2IxOf5vR7vAvSdSA==&#39;)">回复</a><a href="javascript:void(0);" onclick="return QuoteComment(3048876,&#39;vs3M1BMM5nBJBtUIcGABVoLnuhQl5tnL+JkLIg2IxOf5vR7vAvSdSA==&#39;)">引用</a></span></div>
		</li>
	
		<li class="alt">
			<h5>
				<cite><a href="http://www.cnblogs.com/haippy/p/3279565.html#3117844" class="layer">#4楼</a><a name="3117844" id="comment_anchor_3117844"></a></cite> <a id="a_comment_author_3117844" href="http://home.cnblogs.com/u/718854/" target="_blank">luckyzdl</a> <a href="http://msg.cnblogs.com/send/luckyzdl" title="发送站内短消息" class="sendMsg2This">&nbsp;</a><small> <span class="comment_date">2015-01-28 16:52</span></small>
			</h5>
			<div id="comment_body_3117844" class="blog_comment_body">楼主你好，请问为什么<br>std::thread (std::move(tsk), 100)<br>用std::move封装tsk?</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3117844,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3117844,&#39;Bury&#39;,this)">反对(0)</a></div>
			<div class="opt_comment"><span class="comment_actions"><a href="javascript:void(0);" onclick="return ReplyComment(3117844,&#39;bMnWbFEeLVJSw7IFBRPB9jPHjBkFXd3ZNSJ+7EJChSMdC/Q6IdEt1Q==&#39;)">回复</a><a href="javascript:void(0);" onclick="return QuoteComment(3117844,&#39;bMnWbFEeLVJSw7IFBRPB9jPHjBkFXd3ZNSJ+7EJChSMdC/Q6IdEt1Q==&#39;)">引用</a></span></div>
		</li>
	
		<li class="alt">
			<h5>
				<cite><a href="http://www.cnblogs.com/haippy/p/3279565.html#3118807" class="layer">#5楼</a><a name="3118807" id="comment_anchor_3118807"></a></cite> <a id="a_comment_author_3118807" href="http://home.cnblogs.com/u/718854/" target="_blank">luckyzdl</a> <a href="http://msg.cnblogs.com/send/luckyzdl" title="发送站内短消息" class="sendMsg2This">&nbsp;</a><small> <span class="comment_date">2015-01-29 15:04</span></small>
			</h5>
			<div id="comment_body_3118807" class="blog_comment_body">你好，楼主，<br>std::packaged_task::reset() 这里面的程序运行出错，我的编译器是g++4.7,错误信息如下：<br>The triple of 100 is 300.<br>terminate called after throwing an instance of 'std::future_error'<br>  what():  No associated state。<br><br>求解答</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3118807,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3118807,&#39;Bury&#39;,this)">反对(0)</a></div>
			<div class="opt_comment"><span class="comment_actions"><a href="javascript:void(0);" onclick="return ReplyComment(3118807,&#39;bMnWbFEeLVJSw7IFBRPB9jPHjBkFXd3ZNSJ+7EJChSMdC/Q6IdEt1Q==&#39;)">回复</a><a href="javascript:void(0);" onclick="return QuoteComment(3118807,&#39;bMnWbFEeLVJSw7IFBRPB9jPHjBkFXd3ZNSJ+7EJChSMdC/Q6IdEt1Q==&#39;)">引用</a></span></div>
		</li>
	
		<li class="alt">
			<h5>
				<cite><a href="http://www.cnblogs.com/haippy/p/3279565.html#3118826" class="layer">#6楼</a><a name="3118826" id="comment_anchor_3118826"></a></cite> <a id="a_comment_author_3118826" href="http://home.cnblogs.com/u/718854/" target="_blank">luckyzdl</a> <a href="http://msg.cnblogs.com/send/luckyzdl" title="发送站内短消息" class="sendMsg2This">&nbsp;</a><small> <span class="comment_date">2015-01-29 15:16</span></small>
			</h5>
			<div id="comment_body_3118826" class="blog_comment_body">把 std::thread (std::move(tsk), 100).detach();这行换成<br>tsk(100); 就好了~ <br>不知道为什么，难道 std::move(tsk)不能用2遍？<br>如果第一处线程还是用std::move<br>而第二处线程改成 tsk(200); 还是出错</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3118826,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3118826,&#39;Bury&#39;,this)">反对(0)</a></div>
			<div class="opt_comment"><span class="comment_actions"><a href="javascript:void(0);" onclick="return ReplyComment(3118826,&#39;bMnWbFEeLVJSw7IFBRPB9jPHjBkFXd3ZNSJ+7EJChSMdC/Q6IdEt1Q==&#39;)">回复</a><a href="javascript:void(0);" onclick="return QuoteComment(3118826,&#39;bMnWbFEeLVJSw7IFBRPB9jPHjBkFXd3ZNSJ+7EJChSMdC/Q6IdEt1Q==&#39;)">引用</a></span></div>
		</li>
	
		<li class="alt">
			<h5>
				<cite><a href="http://www.cnblogs.com/haippy/p/3279565.html#3118834" class="layer">#7楼</a><a name="3118834" id="comment_anchor_3118834"></a></cite> <a id="a_comment_author_3118834" href="http://home.cnblogs.com/u/718854/" target="_blank">luckyzdl</a> <a href="http://msg.cnblogs.com/send/luckyzdl" title="发送站内短消息" class="sendMsg2This">&nbsp;</a><small> <span class="comment_date">2015-01-29 15:20</span></small>
			</h5>
			<div id="comment_body_3118834" class="blog_comment_body"><a href="http://www.cnblogs.com/haippy/p/3279565.html#2978493" title="查看所回复的评论" onclick="commentManager.renderComments(0,50,2978493);">@</a>
sssaa<br>什么原因？<br>我把第一处线程调用那，改成 tsk(100); 就好了，要不reset后，线程std::move调用任务，运行出错</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3118834,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3118834,&#39;Bury&#39;,this)">反对(0)</a></div>
			<div class="opt_comment"><span class="comment_actions"><a href="javascript:void(0);" onclick="return ReplyComment(3118834,&#39;bMnWbFEeLVJSw7IFBRPB9jPHjBkFXd3ZNSJ+7EJChSMdC/Q6IdEt1Q==&#39;)">回复</a><a href="javascript:void(0);" onclick="return QuoteComment(3118834,&#39;bMnWbFEeLVJSw7IFBRPB9jPHjBkFXd3ZNSJ+7EJChSMdC/Q6IdEt1Q==&#39;)">引用</a></span></div>
		</li>
	
		<li class="alt">
			<h5>
				<cite><a href="http://www.cnblogs.com/haippy/p/3279565.html#3252377" class="layer">#8楼</a><a name="3252377" id="comment_anchor_3252377"></a></cite> <a id="a_comment_author_3252377" href="http://home.cnblogs.com/u/801598/" target="_blank">damon_loo</a> <a href="http://msg.cnblogs.com/send/damon_loo" title="发送站内短消息" class="sendMsg2This">&nbsp;</a><small> <span class="comment_date">2015-08-22 17:52</span></small>
			</h5>
			<div id="comment_body_3252377" class="blog_comment_body">最后一个出错是必然的，std::thread (std::move(tsk), 100).detach();已经将tsk的控制权转移了，tsk 到了后面已经是无效的了， tsk.reset()调用会操作指针，指针已经为空了，所以崩溃，详细用法可以参考：www.cplusplus.com/reference/future/packaged_task/reset/<br><br><b>建议楼主修改一下，最后一个例子，避免后来的同学们迷惑！TKS</b></div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3252377,&#39;Digg&#39;,this)">支持(1)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3252377,&#39;Bury&#39;,this)">反对(0)</a></div>
			<div class="opt_comment"><span class="comment_actions"><a href="javascript:void(0);" onclick="return ReplyComment(3252377,&#39;8Hk4Lmn74ydC1YU2h/Tacvf+/a75PBUmW8GZ/JL8T2k+yeDtaKt1Ng==&#39;)">回复</a><a href="javascript:void(0);" onclick="return QuoteComment(3252377,&#39;8Hk4Lmn74ydC1YU2h/Tacvf+/a75PBUmW8GZ/JL8T2k+yeDtaKt1Ng==&#39;)">引用</a></span></div>
		</li>
	
		<li class="alt">
			<h5>
				<cite><a href="http://www.cnblogs.com/haippy/p/3279565.html#3370978" class="layer">#9楼</a><a name="3370978" id="comment_anchor_3370978"></a></cite> <a id="a_comment_author_3370978" href="http://www.cnblogs.com/IamTing/" target="_blank">越傻越快乐</a> <a href="http://msg.cnblogs.com/send/%E8%B6%8A%E5%82%BB%E8%B6%8A%E5%BF%AB%E4%B9%90" title="发送站内短消息" class="sendMsg2This">&nbsp;</a><small> <span class="comment_date">2016-03-03 12:15</span></small>
			</h5>
			<div id="comment_body_3370978" class="blog_comment_body"><a href="http://www.cnblogs.com/haippy/p/3279565.html#3252377" title="查看所回复的评论" onclick="commentManager.renderComments(0,50,3252377);">@</a>
damon_loo<br><fieldset class="comment_quote"><legend><a href="http://www.cnblogs.com/haippy/p/3279565.html#3252377" title="查看引用原文">引用</a></legend>最后一个出错是必然的，std::thread (std::move(tsk), 100).detach();已经将tsk的控制权转移了，tsk 到了后面已经是无效的了， tsk.reset()调用会操作指针，指针已经为空了，所以崩溃，详细用法可以参考：www.cplusplus.com/reference/future/packaged_task/reset/<br><br>建议楼主修改一下，最后一个例子，避免后来的同学们迷惑！TKS</fieldset><br>第一个std::move函数把tsk的资源移走了，再一次std::move对资源为空的tsk移动就会出错啦</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3370978,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3370978,&#39;Bury&#39;,this)">反对(0)</a></div>
			<div class="opt_comment"><span class="comment_actions"><a href="javascript:void(0);" onclick="return ReplyComment(3370978,&#39;Hc3lPiS8/ubsHpRkEJR5j5u0kXiflBEDbHBysWAvGGQX9XyodSYniA==&#39;)">回复</a><a href="javascript:void(0);" onclick="return QuoteComment(3370978,&#39;Hc3lPiS8/ubsHpRkEJR5j5u0kXiflBEDbHBysWAvGGQX9XyodSYniA==&#39;)">引用</a></span></div>
		</li>
	
		<li class="alt">
			<h5>
				<cite><a href="http://www.cnblogs.com/haippy/p/3279565.html#3452352" class="layer">#10楼</a><a name="3452352" id="comment_anchor_3452352"></a><span id="comment-maxId" style="display:none;">3452352</span><span id="comment-maxDate" style="display:none;">2016/6/15 9:35:48</span></cite> <a id="a_comment_author_3452352" href="http://www.cnblogs.com/break-python/" target="_blank">Esapinit</a> <a href="http://msg.cnblogs.com/send/Esapinit" title="发送站内短消息" class="sendMsg2This">&nbsp;</a><small> <span class="comment_date">2016-06-15 09:35</span></small>
			</h5>
			<div id="comment_body_3452352" class="blog_comment_body">最后一个例子中的第一个std::move应该改成std::ref就可以了</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3452352,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3452352,&#39;Bury&#39;,this)">反对(0)</a></div><span id="comment_3452352_avatar" style="display:none;">http://pic.cnblogs.com/face/678846/20141225212052.png</span>
			<div class="opt_comment"><span class="comment_actions"><a href="javascript:void(0);" onclick="return ReplyComment(3452352,&#39;upOlpkxBeRxsD4fvz/5NcSDQVfL+/B7DwYDmqqg0GKqe5WnsLx3LDA==&#39;)">回复</a><a href="javascript:void(0);" onclick="return QuoteComment(3452352,&#39;upOlpkxBeRxsD4fvz/5NcSDQVfL+/B7DwYDmqqg0GKqe5WnsLx3LDA==&#39;)">引用</a></span></div>
		</li>
	
</ol>

<div id="comments_pager_bottom"></div></div><script type="text/javascript">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>
<div id="comment_form" class="commentform">
<a name="commentform"></a>
<div id="divCommentShow"></div>
<div id="comment_nav"><span id="span_refresh_tips"></span><a href="javascript:void(0);" onclick="return RefreshCommentList();" id="lnk_RefreshComments" runat="server" clientidmode="Static">刷新评论</a><a href="http://www.cnblogs.com/haippy/p/3279565.html#" onclick="return RefreshPage();">刷新页面</a><a href="http://www.cnblogs.com/haippy/p/3279565.html#top">返回顶部</a></div>
<div id="comment_form_container">
<div id="commentform_title">发表评论</div>
<span id="tip_comment" style="color:Red"></span>
<p>
昵称：<input type="text" id="tbCommentAuthor" class="author" disabled="disabled" size="50" value="zhenghua">
</p>
<div class="commentbox_main">
<div class="commentbox_title">
<div class="commentbox_title_left">评论内容：</div>
<div class="commentbox_title_right">
<img id="ubb_quote" class="comment_icon" src="./C++11 并发指南四(_future_ 详解二 std__packaged_task 介绍) - Haippy - 博客园_files/quote.gif" alt="引用" title="添加引用" onclick="insertUBB(&#39;tbCommentBody&#39;,&#39;quote&#39;)">
<img id="ubb_bold" class="comment_icon" src="./C++11 并发指南四(_future_ 详解二 std__packaged_task 介绍) - Haippy - 博客园_files/b.png" alt="粗体" title="添加粗体" onclick="insertUBB(&#39;tbCommentBody&#39;,&#39;b&#39;)">
<img id="ubb_url" class="comment_icon" src="./C++11 并发指南四(_future_ 详解二 std__packaged_task 介绍) - Haippy - 博客园_files/lk.png" alt="链接" title="添加链接" onclick="insertUbbUrl(&#39;tbCommentBody&#39;)">
<img id="ubb_indent" class="comment_icon" src="./C++11 并发指南四(_future_ 详解二 std__packaged_task 介绍) - Haippy - 博客园_files/indent.png" alt="缩进" title="添加首行缩进" onclick="insertIndent(&#39;tbCommentBody&#39;)">
<img id="ubb_code" class="comment_icon" src="./C++11 并发指南四(_future_ 详解二 std__packaged_task 介绍) - Haippy - 博客园_files/InsertCode.gif" alt="代码" title="添加代码" onclick="insertUbbCode()">
<img id="ubb_img" class="comment_icon" src="./C++11 并发指南四(_future_ 详解二 std__packaged_task 介绍) - Haippy - 博客园_files/img.gif" alt="图片" title="上传图片" onclick="OpenImageUploadWindow();">
</div>
</div>
<div class="clear"></div>
<textarea id="tbCommentBody" class="comment_textarea"></textarea>
</div>
<p id="commentbox_opt">
<input id="btn_comment_submit" type="button" class="comment_btn" value="提交评论">
<span id="span_comment_canceledit" style="display:none"><a href="javascript:void(0);" onclick="return CancelCommentEdit()">不改了</a></span>
<a href="javascript:void(0);" onclick="return logout();">退出登录</a>
        <a id="commentbox_opt_sub" href="javascript:void(0);" title="订阅后有新评论时会邮件通知您" onclick="commentManager.Subscribe()">订阅评论</a>
</p>
<div id="tip_comment2" style="color:Red"></div>
<p>
[Ctrl+Enter快捷键提交]
</p>
<div style="display:none">
<span id="comment_edit_id"></span><span id="span_parentcomment_id"></span>
<span id="span_parent_id"></span>
<span id="span_comment_replyto"></span>
<span id="span_comment_posted"></span>
</div>
</div>
<div class="ad_text_commentbox" id="ad_text_under_commentbox"></div>
<div id="ad_t2"><a href="http://www.ucancode.com/index.htm" target="_blank">【推荐】50万行VC++源码: 大型组态工控、电力仿真CAD与GIS源码库</a><br><a href="http://rongcloud.cn/reports/journal2" target="_blank">【推荐】融云发布 App 社交化白皮书 IM 提升活跃超 8 倍</a><br><a href="http://bbs.h3bpm.com/index.php?m=app&amp;app=product_download&amp;a=reg&amp;utm_source=csdn&amp;utm_medium=pic&amp;utm_campaign=show&amp;utm_content=v10&amp;utm_term=%E5%85%8D%E8%B4%B9%E4%B8%8B%E8%BD%BD" target="_blank">【推荐】自开发 零实施的BPM</a><br></div>
<div id="opt_under_post"></div>
<div id="ad_c1" class="c_ad_block"><a href="https://cn.udacity.com/course/deep-learning-nanodegree-foundation--nd101/?utm_source=cnblogB3&amp;utm_medium=referral&amp;utm_campaign=nd101launch" target="_blank"><img width="300" height="250" src="./C++11 并发指南四(_future_ 详解二 std__packaged_task 介绍) - Haippy - 博客园_files/24442-20170120162217812-818299692.jpg" alt=""></a></div>
<div id="under_post_news"><div class="itnews c_ad_block"><b>最新IT新闻</b>:<br> ·  <a href="http://news.cnblogs.com/n/562060/" target="_blank">Edge浏览器正式支持WebRTC 1.0：开视频暴爽</a><br> ·  <a href="http://news.cnblogs.com/n/562059/" target="_blank">HTC动荡：全球副总裁今日离职</a><br> ·  <a href="http://news.cnblogs.com/n/562058/" target="_blank">Mozilla Firefox 52 Beta 2发布</a><br> ·  <a href="http://news.cnblogs.com/n/562057/" target="_blank">谷歌工程师：微软家的Defender表现得最像一款杀毒软件</a><br> ·  <a href="http://news.cnblogs.com/n/562056/" target="_blank">亚马逊斥资15亿美元开设它自己的航空货运中心</a><br>» <a href="http://news.cnblogs.com/" title="IT新闻" target="_blank">更多新闻...</a></div></div>
<div id="ad_c2" class="c_ad_block"><a href="http://bbs.h3bpm.com/index.php?m=app&amp;app=product_download&amp;a=reg&amp;utm_source=csdn&amp;utm_medium=pic&amp;utm_campaign=show&amp;utm_content=v10&amp;utm_term=%E5%85%8D%E8%B4%B9%E4%B8%8B%E8%BD%BD" target="_blank"><img width="468" height="60" src="./C++11 并发指南四(_future_ 详解二 std__packaged_task 介绍) - Haippy - 博客园_files/24442-20170118152220281-363324784.jpg" alt=""></a></div>
<div id="under_post_kb"><div class="itnews c_ad_block" id="kb_block"><b>最新知识库文章</b>:<br><div id="kb_recent"> ·  <a href="http://kb.cnblogs.com/page/554260/" target="_blank">「代码家」的学习过程和学习经验分享</a><br> ·  <a href="http://kb.cnblogs.com/page/556770/" target="_blank">写给未来的程序媛</a><br> ·  <a href="http://kb.cnblogs.com/page/558087/" target="_blank">高质量的工程代码为什么难写</a><br> ·  <a href="http://kb.cnblogs.com/page/555750/" target="_blank">循序渐进地代码重构</a><br> ·  <a href="http://kb.cnblogs.com/page/554496/" target="_blank">技术的正宗与野路子</a><br></div>» <a href="http://kb.cnblogs.com/" target="_blank">更多知识库文章...</a></div></div>
<div id="HistoryToday" class="c_ad_block"></div>
<script type="text/javascript">
    fixPostBody();
    setTimeout(function () { incrementViewCount(cb_entryId); }, 50);
    deliverAdT2();
    deliverAdC1();
    deliverAdC2();    
    loadNewsAndKb();
    loadBlogSignature();
    LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);
    GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate);
    loadOptUnderPost();
    GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);   
</script>
</div>


        </div>

        <script type="text/javascript">
            var m = window.__blog.contentRendered;
            if (m) { m(__$("content")); }
        </script>

        <div id="sidebar">
            
<div id="about">
<div>
<h2 id="about_title">About</h2>
<div id="about_body">
<div id="blog-news"><!--{cps..0}{cps..2}{cps..1}-->
<!-- JiaThis Button BEGIN -->

<!-- JiaThis Button END -->
<a href="http://weibo.com/1702076100?s=6uyXnP" target="_blank"><img src="./C++11 并发指南四(_future_ 详解二 std__packaged_task 介绍) - Haippy - 博客园_files/5.png" alt="" border="0"></a>
<p align="center" style="background-color: #92d050;padding: 5px;color: white;font-weight: bold;border: solid 2px black;text-shadow: 0px 0px 3px black;">
访问
<a style="color: #FFE249;" target="_blank" href="http://yibo.iyiyun.com/Home/js/yibo404">404公益</a>
帮助妈妈找回走失的孩子！
</p>
<p><strong>基本信息</strong></p>
<blockquote>
<blockquote><p>昵称：Forhappy &amp;&amp; Haippy <br>
</p>
</blockquote>
<blockquote><p>Github：<a target="_blank" href="https://github.com/forhappy">https://github.com/forhappy <br></a></p></blockquote>
<p>-----------------------------------------------------------------<br>
</p>
<p><strong>关注领域</strong><br>
</p>
<blockquote>自由软件，GNU/Linux</blockquote><blockquote>大规模数据处理，分布式系统，NOSQL，编程框架</blockquote><blockquote>应用程序调试 </blockquote>
<p>-----------------------------------------------------------------<br>
</p>
<blockquote>

</blockquote>


<blockquote><div align="center">
<!-- RevolverMaps Flash发布代码开始 -->
<object data="./C++11 并发指南四(_future_ 详解二 std__packaged_task 介绍) - Haippy - 博客园_files/g.swf.下载" type="application/x-shockwave-flash" id="rm_3a3sZq" width="288" height="288"><param name="movie" value="http://ri.revolvermaps.com/f/g.swf"><param name="allowNetworking" value="all"><param name="allowScriptAccess" value="always"><param name="wmode" value="window"><param name="flashvars" value="m=0&amp;n=false&amp;b=000000&amp;r=true&amp;i=a6l61an3m0y&amp;v=true&amp;c=ff0000&amp;s=288"></object><noscript>&lt;applet codebase="http://rk.revolvermaps.com/j" code="core.RE" width="288" height="288" archive="g.jar"&gt;&lt;param name="cabbase" value="g.cab" /&gt;&lt;param name="r" value="true" /&gt;&lt;param name="n" value="false" /&gt;&lt;param name="i" value="a6l61an3m0y" /&gt;&lt;param name="m" value="0" /&gt;&lt;param name="s" value="288" /&gt;&lt;param name="c" value="ff0000" /&gt;&lt;param name="v" value="true" /&gt;&lt;param name="b" value="000000" /&gt;&lt;param name="rfc" value="true" /&gt;&lt;/applet&gt;</noscript>
<!-- RevolverMaps Flash发布代码结束 -->
</div></blockquote><div id="profile_block">昵称：<a href="http://home.cnblogs.com/u/haippy/">Haippy</a><br>园龄：<a href="http://home.cnblogs.com/u/haippy/" title="入园时间：2011-02-19">5年11个月</a><br>粉丝：<a href="http://home.cnblogs.com/u/haippy/followers/">447</a><br>关注：<a href="http://home.cnblogs.com/u/haippy/followees/">37</a><div id="p_b_follow">已关注 <a href="javascript:void(0);" onclick="unfollow(&#39;bcaec1c6-ed3b-e011-ac81-842b2b196315&#39;)">-取消</a></div></div></blockquote></div>
<script type="text/javascript">loadBlogNews();</script>
</div>
</div>
</div>

            <script type="text/javascript">
                var m = window.__blog.aboutRendered;
                if (m) { m(__$("about")); }
            </script>
            
<div id="mySearchWrapper">
    <div id="mySearch">
        <input type="image" src="./C++11 并发指南四(_future_ 详解二 std__packaged_task 介绍) - Haippy - 博客园_files/btnsearch.gif" id="btnZzk" class="submit" onclick="zzk_go();return false;">
        <label class="lb_search"><input type="text" id="q" onkeydown="return zzk_go_enter(event);" class="keyword"></label>
    </div>
</div>

            <script type="text/javascript">
                var m = window.__blog.searchFormRendered;
                if (m) { m(__$("searchform")); }
            </script>
            <div id="sideMain">
            <div id="side-recent-posts">
        <h2>最新随笔</h2>
        <ul class="bullet">
                <li><a href="http://www.cnblogs.com/haippy/p/4869093.html">RegexKit: A Regular Expression Toolbox Based On NW.js(Node-Webkit) And Other Greate Open Source Projects.</a></li>
                <li><a href="http://www.cnblogs.com/haippy/p/3412858.html">C++11 并发指南七(C++11 内存模型一：介绍)</a></li>
                <li><a href="http://www.cnblogs.com/haippy/p/3346477.html">C++11 并发指南三(Lock 详解)</a></li>
                <li><a href="http://www.cnblogs.com/haippy/p/3306625.html">C++11 并发指南六(atomic 类型详解四 C 风格原子操作介绍)</a></li>
                <li><a href="http://www.cnblogs.com/haippy/p/3304556.html">C++11 并发指南六(atomic 类型详解三 std::atomic (续))</a></li>
                <li><a href="http://www.cnblogs.com/haippy/p/3301408.html">C++11 并发指南六( &lt;atomic&gt; 类型详解二 std::atomic )</a></li>
                <li><a href="http://www.cnblogs.com/haippy/p/3252056.html">C++11 并发指南六(atomic 类型详解一 atomic_flag 介绍)</a></li>
                <li><a href="http://www.cnblogs.com/haippy/p/3293308.html">C++11 并发指南后续更新</a></li>
                <li><a href="http://www.cnblogs.com/haippy/p/3252041.html">C++11 并发指南五(std::condition_variable 详解)</a></li>
                <li><a href="http://www.cnblogs.com/haippy/p/3284540.html">C++11 并发指南系列</a></li>
        </ul>
    </div><div id="side-recent-comments">
        <h2>最新评论</h2>
        <ul class="voice">
                <li>
                    <a href="http://www.cnblogs.com/haippy/p/3284540.html#3604782">Re:C++11 并发指南系列</a>
                    <br>
                    <a class="child" href="http://www.cnblogs.com/haippy/p/3284540.html#3604782">
                        作为小白，学起来非常好。
                        -- hackTang
                    </a>
                </li>
                <li>
                    <a href="http://www.cnblogs.com/haippy/archive/2012/05/18/2507337.html#3587153">Re:我常用的Latex中文报告模板(一)</a>
                    <br>
                    <a class="child" href="http://www.cnblogs.com/haippy/archive/2012/05/18/2507337.html#3587153">
                        我也没找到后面一篇，囧
                        -- data_node
                    </a>
                </li>
                <li>
                    <a href="http://www.cnblogs.com/haippy/p/3236136.html#3577848">Re:C++11 并发指南二(std::thread 详解)</a>
                    <br>
                    <a class="child" href="http://www.cnblogs.com/haippy/p/3236136.html#3577848">
                        @Haippy
感觉拷贝构造和移动构造不经过特殊训练很难了解清晰
                        -- 风吹鸡蛋水灵灵
                    </a>
                </li>
                <li>
                    <a href="http://www.cnblogs.com/haippy/archive/2012/07/05/2577233.html#3574755">Re:7天学会Maven（第二天——Maven 标准目录结构）</a>
                    <br>
                    <a class="child" href="http://www.cnblogs.com/haippy/archive/2012/07/05/2577233.html#3574755">
                        屁用没有！
                        -- 取经的曲
                    </a>
                </li>
                <li>
                    <a href="http://www.cnblogs.com/haippy/archive/2013/06/10/3131373.html#3564677">Re:CEF3 笔记一(介绍)</a>
                    <br>
                    <a class="child" href="http://www.cnblogs.com/haippy/archive/2013/06/10/3131373.html#3564677">
                        博主，你的“可以看看这篇文章对 CEF 的介绍”中的那个链接有问题啊。。。
                        -- 闻波
                    </a>
                </li>
                <li>
                    <a href="http://www.cnblogs.com/haippy/archive/2011/12/10/2282943.html#3547445">Re:一致性hash算法释义</a>
                    <br>
                    <a class="child" href="http://www.cnblogs.com/haippy/archive/2011/12/10/2282943.html#3547445">
                        @xqy181822137
可以多设些虚拟节点，数据对象本身hash之后也未必均匀
                        -- everything-just-tool
                    </a>
                </li>
                <li>
                    <a href="http://www.cnblogs.com/haippy/p/3284540.html#3526043">Re:C++11 并发指南系列</a>
                    <br>
                    <a class="child" href="http://www.cnblogs.com/haippy/p/3284540.html#3526043">
                        强烈支持
                        -- 一晌贪欢
                    </a>
                </li>
                <li>
                    <a href="http://www.cnblogs.com/haippy/archive/2013/03/17/2963995.html#3521371">Re:libuv 中文编程指南(零)前言</a>
                    <br>
                    <a class="child" href="http://www.cnblogs.com/haippy/archive/2013/03/17/2963995.html#3521371">
                        还没翻译完啊
                        -- _Ong
                    </a>
                </li>
                <li>
                    <a href="http://www.cnblogs.com/haippy/archive/2012/09/02/2668099.html#3509255">Re:如何将 Linux 内核实现的红黑树 rbtree 运用到你的 C 程序中？</a>
                    <br>
                    <a class="child" href="http://www.cnblogs.com/haippy/archive/2012/09/02/2668099.html#3509255">
                        @凌风问天
不需要的,struct rb_node node这个成员变量是结构体，而不是指针。
                        -- AdrianMonk
                    </a>
                </li>
                <li>
                    <a href="http://www.cnblogs.com/haippy/archive/2011/12/04/2276064.html#3503351">Re:数据分析与处理之二（Leveldb 实现原理）</a>
                    <br>
                    <a class="child" href="http://www.cnblogs.com/haippy/archive/2011/12/04/2276064.html#3503351">
                        好多图挂了，麻烦补下
                        -- Himer
                    </a>
                </li>
        </ul>
    </div></div>
            <div id="sideRight">
            <div id="side-archives">
        <h2>随笔档案</h2>
        <ul class="date">
                <li><a href="http://www.cnblogs.com/haippy/archive/2015/10.html">2015年10月(1)</a></li>
                <li><a href="http://www.cnblogs.com/haippy/archive/2013/11.html">2013年11月(1)</a></li>
                <li><a href="http://www.cnblogs.com/haippy/archive/2013/10.html">2013年10月(1)</a></li>
                <li><a href="http://www.cnblogs.com/haippy/archive/2013/09.html">2013年9月(4)</a></li>
                <li><a href="http://www.cnblogs.com/haippy/archive/2013/08.html">2013年8月(10)</a></li>
                <li><a href="http://www.cnblogs.com/haippy/archive/2013/07.html">2013年7月(1)</a></li>
                <li><a href="http://www.cnblogs.com/haippy/archive/2013/06.html">2013年6月(3)</a></li>
                <li><a href="http://www.cnblogs.com/haippy/archive/2013/05.html">2013年5月(3)</a></li>
                <li><a href="http://www.cnblogs.com/haippy/archive/2013/04.html">2013年4月(2)</a></li>
                <li><a href="http://www.cnblogs.com/haippy/archive/2013/03.html">2013年3月(6)</a></li>
                <li><a href="http://www.cnblogs.com/haippy/archive/2013/02.html">2013年2月(9)</a></li>
                <li><a href="http://www.cnblogs.com/haippy/archive/2013/01.html">2013年1月(2)</a></li>
                <li><a href="http://www.cnblogs.com/haippy/archive/2012/12.html">2012年12月(3)</a></li>
                <li><a href="http://www.cnblogs.com/haippy/archive/2012/11.html">2012年11月(1)</a></li>
                <li><a href="http://www.cnblogs.com/haippy/archive/2012/10.html">2012年10月(2)</a></li>
                <li><a href="http://www.cnblogs.com/haippy/archive/2012/09.html">2012年9月(3)</a></li>
                <li><a href="http://www.cnblogs.com/haippy/archive/2012/08.html">2012年8月(3)</a></li>
                <li><a href="http://www.cnblogs.com/haippy/archive/2012/07.html">2012年7月(14)</a></li>
                <li><a href="http://www.cnblogs.com/haippy/archive/2012/06.html">2012年6月(1)</a></li>
                <li><a href="http://www.cnblogs.com/haippy/archive/2012/05.html">2012年5月(5)</a></li>
                <li><a href="http://www.cnblogs.com/haippy/archive/2012/04.html">2012年4月(1)</a></li>
                <li><a href="http://www.cnblogs.com/haippy/archive/2012/01.html">2012年1月(5)</a></li>
                <li><a href="http://www.cnblogs.com/haippy/archive/2011/12.html">2011年12月(21)</a></li>
                <li><a href="http://www.cnblogs.com/haippy/archive/2011/10.html">2011年10月(4)</a></li>
                <li><a href="http://www.cnblogs.com/haippy/archive/2011/09.html">2011年9月(4)</a></li>
        </ul>
    </div><div id="side-link-398733">
            <h2>Latex</h2>
            <ul class="chain">
                        <li>
                            <a href="http://docs.latexlab.org/" target="_self">Latex 在线编译工具</a>
                        </li>
                        <li>
                            <a href="http://latex.howtotex.com/" target="_self">国外名校 Latex 模板汇总</a>
                        </li>
            </ul>
        </div><div id="side-link-322763">
            <h2>Linux</h2>
            <ul class="chain">
                        <li>
                            <a href="http://www.wangafu.net/~nickm/libevent-book/" target="_self">Fast portable non-blocking network programming with Libevent</a>
                        </li>
                        <li>
                            <a href="http://www.jmarshall.com/easy/http/" target="_self">HTTP Made Really Easy</a>
                        </li>
                        <li>
                            <a href="http://learncodethehardway.org/" target="_self">Learn code the hard way</a>
                        </li>
                        <li>
                            <a href="http://locklessinc.com/articles/locks/" target="_self">如何设计自旋锁和读写锁</a>
                        </li>
                        <li>
                            <a href="http://www.websequencediagrams.com/" target="_self">在线UML小工具</a>
                        </li>
            </ul>
        </div><div id="side-link-348355">
            <h2>Network Programming</h2>
            <ul class="chain">
                        <li>
                            <a href="http://beej.us/guide/bgnet/output/html/multipage/index.html" target="_self">Beej's Guide to Network Programming</a>
                        </li>
            </ul>
        </div><div id="side-link-341299">
            <h2>NoSQL</h2>
            <ul class="chain">
                        <li>
                            <a href="https://acunu-videos.s3.amazonaws.com/dajs.html" target="_self">acunu-Double Array Demo</a>
                        </li>
                        <li>
                            <a href="http://www.cnblogs.com/haippy/p/nosql-databases.org" target="_self">nosql-collections</a>
                        </li>
            </ul>
        </div><div id="side-link-322761">
            <h2>Python</h2>
            <ul class="chain">
                        <li>
                            <a href="http://scotdoyle.com/python-epoll-howto.html" target="_self">How To Use Linux epoll with Python</a>
                        </li>
                        <li>
                            <a href="http://www.cnblogs.com/haippy/p/www.python.org" target="_self">Python</a>
                        </li>
                        <li>
                            <a href="http://repl.it/" target="_self">在线python</a>
                        </li>
            </ul>
        </div><div id="side-link-349300">
            <h2>好友链接</h2>
            <ul class="chain">
                        <li>
                            <a href="http://www.binospace.com/" target="_self">冰哥的主页</a>
                        </li>
                        <li>
                            <a href="http://blog.sina.com.cn/maxwell2place" target="_self">崔遥同学</a>
                        </li>
                        <li>
                            <a href="http://blog.imley.net/" target="_blank">姜雷同学</a>
                        </li>
                        <li>
                            <a href="http://luoyi.t15.org/wp/" target="_blank">罗毅同学</a>
                        </li>
            </ul>
        </div><div id="side-link-343532">
            <h2>论文查阅站点</h2>
            <ul class="chain">
                        <li>
                            <a href="http://cn.arxiv.org/" target="_self">cn.arXiv.org</a>
                        </li>
                        <li>
                            <a href="http://dblp.uni-trier.de/" target="_self">DBLP</a>
                        </li>
                        <li>
                            <a href="http://www.doaj.org/" target="_self">DOAJ</a>
                        </li>
                        <li>
                            <a href="http://scholar.google.com/schhp?hl=en&amp;tab=ws" target="_self">Google scholar</a>
                        </li>
            </ul>
        </div></div>
            <div id="sideLeft">
            <div id="side-calendar">
        <h2>日历</h2>
        <div id="blog-calendar"><table id="blogCalendar" class="Cal" cellspacing="0" cellpadding="0" title="Calendar">
	<tbody><tr><td colspan="7"><table class="CalTitle" cellspacing="0">
		<tbody><tr><td class="CalNextPrev"><a href="javascript:void(0);" onclick="loadBlogCalendar(&#39;2017/01/01&#39;);return false;">&lt;</a></td><td align="center">2017年2月</td><td class="CalNextPrev" align="right"><a href="javascript:void(0);" onclick="loadBlogCalendar(&#39;2017/03/01&#39;);return false;">&gt;</a></td></tr>
	</tbody></table></td></tr><tr><th class="CalDayHeader" align="center" abbr="日" scope="col">日</th><th class="CalDayHeader" align="center" abbr="一" scope="col">一</th><th class="CalDayHeader" align="center" abbr="二" scope="col">二</th><th class="CalDayHeader" align="center" abbr="三" scope="col">三</th><th class="CalDayHeader" align="center" abbr="四" scope="col">四</th><th class="CalDayHeader" align="center" abbr="五" scope="col">五</th><th class="CalDayHeader" align="center" abbr="六" scope="col">六</th></tr><tr><td class="CalOtherMonthDay" align="center">29</td><td class="CalOtherMonthDay" align="center">30</td><td class="CalOtherMonthDay" align="center">31</td><td class="CalTodayDay" align="center">1</td><td align="center">2</td><td align="center">3</td><td class="CalWeekendDay" align="center">4</td></tr><tr><td class="CalWeekendDay" align="center">5</td><td align="center">6</td><td align="center">7</td><td align="center">8</td><td align="center">9</td><td align="center">10</td><td class="CalWeekendDay" align="center">11</td></tr><tr><td class="CalWeekendDay" align="center">12</td><td align="center">13</td><td align="center">14</td><td align="center">15</td><td align="center">16</td><td align="center">17</td><td class="CalWeekendDay" align="center">18</td></tr><tr><td class="CalWeekendDay" align="center">19</td><td align="center">20</td><td align="center">21</td><td align="center">22</td><td align="center">23</td><td align="center">24</td><td class="CalWeekendDay" align="center">25</td></tr><tr><td class="CalWeekendDay" align="center">26</td><td align="center">27</td><td align="center">28</td><td class="CalOtherMonthDay" align="center">1</td><td class="CalOtherMonthDay" align="center">2</td><td class="CalOtherMonthDay" align="center">3</td><td class="CalOtherMonthDay" align="center">4</td></tr><tr><td class="CalOtherMonthDay" align="center">5</td><td class="CalOtherMonthDay" align="center">6</td><td class="CalOtherMonthDay" align="center">7</td><td class="CalOtherMonthDay" align="center">8</td><td class="CalOtherMonthDay" align="center">9</td><td class="CalOtherMonthDay" align="center">10</td><td class="CalOtherMonthDay" align="center">11</td></tr>
</tbody></table></div>
    </div><div id="side-categories">
        <h2>随笔分类</h2>
        <ul class="folder">
                <li>
                    
                    <a href="http://www.cnblogs.com/haippy/category/381853.html">C &amp; C++(37)</a>
                </li>
                <li>
                    
                    <a href="http://www.cnblogs.com/haippy/category/505027.html">C++11(15)</a>
                </li>
                <li>
                    
                    <a href="http://www.cnblogs.com/haippy/category/488559.html">CEF(3)</a>
                </li>
                <li>
                    
                    <a href="http://www.cnblogs.com/haippy/category/341758.html">IBM developerWorks经典文章(3)</a>
                </li>
                <li>
                    
                    <a href="http://www.cnblogs.com/haippy/category/381852.html">Java(5)</a>
                </li>
                <li>
                    
                    <a href="http://www.cnblogs.com/haippy/category/379987.html">Latex &amp; Texlive(5)</a>
                </li>
                <li>
                    
                    <a href="http://www.cnblogs.com/haippy/category/341759.html">Learning by doing 系列(24)</a>
                </li>
                <li>
                    
                    <a href="http://www.cnblogs.com/haippy/category/341760.html">Linux&amp;C(33)</a>
                </li>
                <li>
                    
                    <a href="http://www.cnblogs.com/haippy/category/341763.html">NoSQL(11)</a>
                </li>
                <li>
                    
                    <a href="http://www.cnblogs.com/haippy/category/341762.html">Programming Toolbox(18)</a>
                </li>
                <li>
                    
                    <a href="http://www.cnblogs.com/haippy/category/341761.html">Python 101(5)</a>
                </li>
                <li>
                    
                    <a href="http://www.cnblogs.com/haippy/category/341765.html">Step By Step 系列(23)</a>
                </li>
                <li>
                    
                    <a href="http://www.cnblogs.com/haippy/category/398525.html">Zookeeper(17)</a>
                </li>
                <li>
                    
                    <a href="http://www.cnblogs.com/haippy/category/341764.html">经典算法回顾(9)</a>
                </li>
                <li>
                    
                    <a href="http://www.cnblogs.com/haippy/category/341757.html">数据分析与处理(20)</a>
                </li>
                <li>
                    
                    <a href="http://www.cnblogs.com/haippy/category/384917.html">转载系列(3)</a>
                </li>
        </ul>
    </div><div id="side-top-posts-custom">
    <h2>推荐排行榜</h2>
    <div id="TopDiggPostsBlock"><ul><li><a href="http://www.cnblogs.com/haippy/archive/2011/12/04/2276064.html">1. 数据分析与处理之二（Leveldb 实现原理）(21)</a></li><li><a href="http://www.cnblogs.com/haippy/p/3284540.html">2. C++11 并发指南系列(15)</a></li><li><a href="http://www.cnblogs.com/haippy/archive/2011/12/10/2282943.html">3. 一致性hash算法释义(13)</a></li><li><a href="http://www.cnblogs.com/haippy/archive/2012/05/20/2509329.html">4. Google Gson 使用简介(12)</a></li><li><a href="http://www.cnblogs.com/haippy/archive/2012/01/09/2317269.html">5. epoll 使用详解(8)</a></li><li><a href="http://www.cnblogs.com/haippy/p/3235560.html">6. C++11 并发指南一(C++11 多线程初探)(8)</a></li><li><a href="http://www.cnblogs.com/haippy/archive/2013/03/17/2963995.html">7. libuv 中文编程指南(零)前言(7)</a></li><li><a href="http://www.cnblogs.com/haippy/p/3228939.html">8. 开始找工作了(5)</a></li><li><a href="http://www.cnblogs.com/haippy/archive/2012/05/18/2507337.html">9. 我常用的Latex中文报告模板(一)(4)</a></li><li><a href="http://www.cnblogs.com/haippy/archive/2012/07/05/2577233.html">10. 7天学会Maven（第二天——Maven 标准目录结构）(4)</a></li></ul></div>
</div><div id="side-top-posts">
    <h2>阅读排行榜</h2>
    <div id="TopViewPostsBlock"><ul><li><a href="http://www.cnblogs.com/haippy/archive/2012/05/20/2509329.html">1. Google Gson 使用简介(77682)</a></li><li><a href="http://www.cnblogs.com/haippy/archive/2011/12/04/2276064.html">2. 数据分析与处理之二（Leveldb 实现原理）(70513)</a></li><li><a href="http://www.cnblogs.com/haippy/p/3236136.html">3. C++11 并发指南二(std::thread 详解)(68168)</a></li><li><a href="http://www.cnblogs.com/haippy/p/3235560.html">4. C++11 并发指南一(C++11 多线程初探)(58876)</a></li><li><a href="http://www.cnblogs.com/haippy/archive/2012/07/05/2577233.html">5. 7天学会Maven（第二天——Maven 标准目录结构）(48822)</a></li><li><a href="http://www.cnblogs.com/haippy/p/3237213.html">6. C++11 并发指南三(std::mutex 详解)(48508)</a></li><li><a href="http://www.cnblogs.com/haippy/archive/2012/07/20/2600077.html">7. Zookeeper 初体验之——JAVA实例(45129)</a></li><li><a href="http://www.cnblogs.com/haippy/archive/2013/05/31/3111560.html">8. C++11 lambda 表达式解析(41842)</a></li><li><a href="http://www.cnblogs.com/haippy/archive/2012/05/18/2507337.html">9. 我常用的Latex中文报告模板(一)(39998)</a></li><li><a href="http://www.cnblogs.com/haippy/archive/2012/07/13/2590351.html">10. 布隆过滤器(Bloom Filter)详解(32993)</a></li></ul></div>
</div>    
    
    
    
    


        
        
        
        
        
        
        
        
        
        
        
<div id="side-link-322764">
            <h2>C/C++</h2>
            <ul class="chain">
                        <li>
                            <a href="http://graphics.stanford.edu/~seander/bithacks.html" target="_self">Bit Twiddling Hacks </a>
                        </li>
                        <li>
                            <a href="http://ccodearchive.net/index.html" target="_self">Comprehensive C Archive Network </a>
                        </li>
                        <li>
                            <a href="http://www.thegeekstuff.com/" target="_self">Geek Stuff</a>
                        </li>
                        <li>
                            <a href="http://www.man7.org/tlpi/code/online/index.html" target="_self">Online Source Code for The Linux Programming Interface</a>
                        </li>
                        <li>
                            <a href="http://sourceforge.net/apps/mediawiki/predef/index.php?title=Main_Page" target="_self">Pre-defined C/C++ Compiler Macros</a>
                        </li>
                        <li>
                            <a href="http://www.cs.nmsu.edu/~pfeiffer/fuse-tutorial/" target="_self">Writing a FUSE Filesystem: a Tutorial</a>
                        </li>
                        <li>
                            <a href="http://www.vincehuston.org/dp/" target="_self">设计模式-图监</a>
                        </li>
            </ul>
        </div><div id="side-link-341300">
            <h2>Miscs</h2>
            <ul class="chain">
                        <li>
                            <a href="http://www.lispmachine.net/" target="_self">Collection of Lisp / Scheme books and online resources</a>
                        </li>
                        <li>
                            <a href="http://figr.bzero.se/" target="_self">figr-简单的在线图片生成工具</a>
                        </li>
                        <li>
                            <a href="http://www.kegel.com/c10k.html" target="_self">The C10K Problem</a>
                        </li>
                        <li>
                            <a href="http://fonts.mobanwang.com/" target="_self">各种字体下载</a>
                        </li>
                        <li>
                            <a href="http://www.eecs.berkeley.edu/~rcs/research/interactive_latency.html" target="_self">开发人员应该知道的各种延迟</a>
                        </li>
                        <li>
                            <a href="http://wiki.ubuntu.org.cn/%E5%85%8D%E8%B4%B9%E4%B8%AD%E6%96%87%E5%AD%97%E4%BD%93" target="_self">免费中文字体</a>
                        </li>
                        <li>
                            <a href="http://marklodato.github.com/visual-git-guide/index-zh-cn.html" target="_self">图解 GIT</a>
                        </li>
                        <li>
                            <a href="http://quickhighlighter.com/" target="_self">在线代码着色工具</a>
                        </li>
                        <li>
                            <a href="http://fayaa.com/code/new/" target="_self">在线代码着色工具-国内</a>
                        </li>
            </ul>
        </div><div id="side-link-534503">
            <h2>OCaml</h2>
            <ul class="chain">
                        <li>
                            <a href="http://www.csc.villanova.edu/~dmatusze/resources/ocaml/ocaml.html" target="_self">A Concise Introduction to Objective Caml</a>
                        </li>
                        <li>
                            <a href="http://www.seas.upenn.edu/~cis120/13fa/programming_style.shtml" target="_blank">CIS120 OCaml Style Guide</a>
                        </li>
                        <li>
                            <a href="http://caml.inria.fr/pub/docs/oreilly-book/html/index.html" target="_blank">Developing Applications With OCaml</a>
                        </li>
                        <li>
                            <a href="http://www.linux-nantes.org/~fmonnier/OCaml/ocaml-wrapping-c.html" target="_blank">How to wrap C functions to OCaml</a>
                        </li>
                        <li>
                            <a href="https://ocaml.janestreet.com/" target="_self">Ocaml@Janestreet</a>
                        </li>
                        <li>
                            <a href="http://www1.cs.columbia.edu/~sedwards/classes/2013/w4115-summer/" target="_self">Programming Languages and Translators</a>
                        </li>
                        <li>
                            <a href="https://realworldocaml.org/v1/en/html/" target="_blank">Real World OCaml</a>
                        </li>
                        <li>
                            <a href="http://caml.inria.fr/pub/docs/manual-ocaml/" target="_blank">The OCaml system---Documentation and user’s manual </a>
                        </li>
            </ul>
        </div><div id="side-link-342083">
            <h2>算法与数据结构</h2>
            <ul class="chain">
                        <li>
                            <a href="http://www.stanford.edu/~blp/avl/index.html" target="_self">GNU libavl</a>
                        </li>
                        <li>
                            <a href="http://www.cnblogs.com/haippy/p/www.sorting-algorithms.com" target="_self">Sorting Algorithm Animations</a>
                        </li>
                        <li>
                            <a href="http://www.cnblogs.com/haippy/p/www.sortvis.org" target="_self">sortvis 排序展示</a>
                        </li>
                        <li>
                            <a href="http://www.cs.usfca.edu/~galles/visualization/Algorithms.html" target="_self">Visualization-Algorithms</a>
                        </li>
                        <li>
                            <a href="http://www.cnblogs.com/haippy/p/www.coolshell.cn/articles/3933.html" target="_self">排序算法的可视化展示(一)</a>
                        </li>
                        <li>
                            <a href="http://eternallyconfuzzled.com/jsw_brain.aspx" target="_self">平衡树AVL Tree，RB Tree学习</a>
                        </li>
            </ul>
        </div></div>
            
                <div id="sideContainer"></div>
                <script type="text/javascript">
                    $.ajax({
                        url: '/' + currentBlogApp + '/mvc/blog/Minyx2_Lite_SideColumn.aspx',
                        data: '{}',
                        type: 'post',
                        dataType: 'text',
                        contentType: 'application/json; charset=utf-8',
                        success: function (data) {
                            if (data) {
                                $("#sideContainer").html(data);
                                loadBlogDefaultCalendar();
                                loadBlogSideBlocks();
                                var m = window.__blog.sideContainerRendered;
                                if (m) { m(__$("sideContainer")); }
                                window.__blog.sidebar.__layout();
                            }
                        }
                    });

                </script>
            
        </div>

        <script type="text/javascript">
            var m = window.__blog.sidebarRendered;
            if (m) { m(__$("sidebar")); }
        </script>

        <div id="footer">
            
<p id="logoFoot">
    <a href="http://www.spiga.com.mx/" title="Agencia Interactiva Spiga">www.spiga.com.mx</a>
</p>
<div class="footText">
<p>
Copyright ©2017 Haippy
</p>
<p>
<a href="http://www.cnblogs.com/">博客园</a>
</p>
</div>
        </div>
    </div>

    <script type="text/javascript">
        var m = window.__blog.wrapperRendered;
        if (m) { m(__$("wrapper")); }
    </script>

</div>
<script type="text/javascript">
    var m = window.__blog.containerRendered;
    if (m) { m(__$("container")); }
</script>
<!--PageEndHtml Block Begin-->
<script src="./C++11 并发指南四(_future_ 详解二 std__packaged_task 介绍) - Haippy - 博客园_files/stat.php" language="JavaScript"></script><script src="./C++11 并发指南四(_future_ 详解二 std__packaged_task 介绍) - Haippy - 博客园_files/core.php" charset="utf-8" type="text/javascript"></script><a href="http://www.cnzz.com/stat/website.php?web_id=3685059" target="_blank" title="站长统计"><img border="0" hspace="0" vspace="0" src="./C++11 并发指南四(_future_ 详解二 std__packaged_task 介绍) - Haippy - 博客园_files/pic.gif"></a>
<!--PageEndHtml Block End-->


</body></html>